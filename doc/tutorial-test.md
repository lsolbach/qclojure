# QClojure Tutorial


<style></style>

<style>.printedClojure .sourceCode {
  background-color: transparent;
  border-style: none;
}
</style>

<style>.clay-limit-image-width .clay-image {max-width: 100%}
.clay-side-by-side .sourceCode {margin: 0}
.clay-side-by-side {margin: 1em 0}
</style>

<script src="tutorial_files/md-default0.js" type="text/javascript"></script>

<script src="tutorial_files/md-default1.js" type="text/javascript"></script>

# QClojure Quantum Computing Tutorial

This tutorial demonstrates the use of the
[QClojure](https://github.com/lsolbach/qclojure) library for quantum
computing. It will introduce you to the fascinating world of quantum
computing and show you how to use QClojure to create and run quantum
programs. It covers

- the creation and visualization of quantum states and quantum registers
- the application of quantum gates
- the creation, visualization and simulation of quantum circuits
- the export and import of quantum data
- the exchange of quantum circuits with other frameworks
- the use of ideal and realistic quantum simulator backends
- the optimization of quantum circuits for specific hardware topologies
- the use of error mitigation techniques
- the description and execution of quantum and hybrid algorithms

## Introduction to Quantum Computing

Quantum computing is a fascinating field that combines computer science,
physics and math. It allows us to perform computations that are not
possible with classical computers. Quantum computers use quantum bits,
or [qubits](https://en.wikipedia.org/wiki/Qubit), which can be in a
superposition of states. This means that a qubit can be in a state of 0,
1, or both at the same time. Quantum computing is based on the
principles of quantum mechanics, which describe the behavior of
particles at the quantum level.

Quantum computing has the potential to revolutionize many fields,
including cryptography, optimization, and machine learning. It can solve
certain problems much faster than classical computers, by performing
many calculations at once. Quantum Algorithms, such as Shor’s algorithm
for factoring large numbers and Grover’s algorithm for searching
unsorted databases, demonstrate the power of quantum computing.

Quantum algorithms are defined in terms of quantum gates, which are
operations that can be applied to qubits. Quantum gates manipulate the
state of qubits and can be combined to create quantum circuits. Quantum
circuits are sequences of quantum gates applied to qubits, similar to
classical logic circuits.

For a general introduction to quantum computing, take a look at

- [Quantum Computing](https://en.wikipedia.org/wiki/Quantum_computing)
- [But what is quantum computing? (Grover’s Algorithm) -
  3blue1brown](https://www.youtube.com/watch?v=RQWpF2Gb-gU)

## QClojure

The QClojure library provides a Clojure interface to quantum computing
concepts. It allows us to create and manipulate quantum states, gates,
and circuits in a functional programming style. QClojure can also be
used to simulate quantum circuits and, by implementing backends, run
them on quantum hardware.

QClojure is focused on the core concepts of quantum computing and
provides a simple and intuitive API to work with quantum states, gates,
and circuits. It also has a comprehensive library of quantum and hybrid
algorithms, including Grover’s search algorithm, the Quantum Approximate
Optimization Algorithm (QAOA), and the Variational Quantum Eigensolver
(VQE).

QClojure also provides visualization functions to visualize quantum
states, circuits and results, making it easier to understand and debug
quantum algorithms.

QClojure is designed to be extensible, allowing the implementation of
backends to run quantum circuits on different quantum hardware. It can
also be extended to specialized domains like quantum chemistry or
quantum machine learning. Those extensions will be available as separate
libraries, to keep the core library focused and lightweight.

QClojure is open source and licensed under the Eclipse Public License
1.0.

This tutorial will guide you through the basics of quantum computing
using QClojure. It is written as a literate programming notebook, which
means that the code and the documentation are interleaved. You can run
the code snippets in a Clojure REPL or generate HTML documentation with
Clay.

### Prerequisites

As QClojure is running on Clojure and Clojure itself on the JVM, you
need to have the following prerequisites installed on your system:

- [JDK 11 or higher](https://openjdk.org/install/)
- [Clojure](https://clojure.org/)
- [Leiningen](https://leiningen.org/) or [Clojure
  CLI](https://clojure.org/guides/getting_started) to manage
  dependencies and run Clojure code.

If you are new to Clojure, I recommend reading the [Clojure Getting
Started Guide](https://clojure.org/guides/getting_started).

### Usage

To use QClojure, you have to include it as a dependency in your Clojure
project.

If you are using Leiningen, add the following dependency to your
`project.clj` file:

``` clojure
[org.soulspace/qclojure "0.14.0"]
```

If you are using Clojure CLI, add the following to your `deps.edn` file:

``` clojure
{:deps {org.soulspace/qclojure {:mvn/version "0.14.0"}}}
```

### Imports

We use kindly to visualize the output of our code. Then we import the
relevant namespaces for the domain concepts of the QClojure library. The
`state` namespace provides functions to create and manipulate quantum
states. The `gate` namespace provides functions to create quantum gates.
The `circuit` namespace provides functions to create and manipulate
quantum circuits.

We also import the visualization namespace and the svg renderer.

<div class="sourceClojure">

``` clojure
(ns tutorial
  (:require
   [fastmath.core :as fm]
   [scicloj.kindly.v4.kind :as kind]
   [org.soulspace.qclojure.domain.state :as state]
   [org.soulspace.qclojure.domain.gate :as gate]
   [org.soulspace.qclojure.domain.circuit :as circuit]
   [org.soulspace.qclojure.application.visualization :as viz]
   [org.soulspace.qclojure.adapter.visualization.ascii :as ascii]
   [org.soulspace.qclojure.adapter.visualization.svg :as svg]
   [org.soulspace.qclojure.adapter.visualization.html :as html]
   [org.soulspace.qclojure.application.backend :as qb]))
```

</div>

Some namespaces, like visualization namespaces contain multimethod
implementations. To make sure that the implementations are loaded, we
require the namespaces. They will not be used directly in the code, only
indirectly by calling the multimethod, so a warning might be shown by
your IDE.

## Quantum States

A quantum state is a mathematical object that describes the state of a
quantum system. In QClojure, quantum states are represented as vectors
of complex numbers. The vector of complex numbers represents the
amplitudes of the basis states, which represent the possible states of
the system. The notation \|⟩ is called a
“[braket](https://en.wikipedia.org/wiki/Dirac_notation)” and is used to
represent a vector in a complex vector space. The Qubit is the basic
unit of quantum information, and it can be in a
[superposition](https://en.wikipedia.org/wiki/Superposition) of the
states \|0⟩ and \|1⟩. A classic bit can be in one of two states, 0 or 1,
but a qubit can be in a superposition of both states. This means that a
qubit can represent 0, 1, or both at the same time, with different
probabilities.

### Measurement

Measurement is the process of extracting classical information from a
quantum state. The measurement process is probabilistic, and the
probability of measuring a certain state depends on the amplitudes of
the basis states in the quantum state. When we measure a quantum state,
we collapse it to one of the basis states with a certain probability.
After measurement, the quantum state is no longer in a superposition,
but in one of the basis states.

The result of the measurement is a classical bit, which can be either 0
or 1. The measurement process is a fundamental aspect of quantum
mechanics and is described by the [Born
rule](https://en.wikipedia.org/wiki/Born_rule). The Born rule states
that the probability of measuring a certain state is equal to the square
of the amplitude of that state in the quantum state vector.

### Basic Quantum States

The *qs* namespace defines some basic quantum states. Let’s look at the
quantum state \|0⟩, which is the ground state of a qubit.

<div class="sourceClojure">

``` clojure
state/|0⟩
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[1.0 0.0] [0.0 0.0]], :num-qubits 1}
```

</div>

The measured value of a quantum state is probabilistic. We have a
probability of measuring the state \|0⟩ as 0, and a probability of
measuring it as 1. We can visualize the probability distribution of the
quantum state \|0⟩.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg state/|0⟩))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.0" y2="204.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.0">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.0" y2="156.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.0">60%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.0" y2="108.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.0">80%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.0" y2="60.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.0">100%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="478" x="80" y="60.0"><title>|0⟩: 100.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="320" y="320">|0⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="320" y="55.0">100.0%</text></g></svg>

It shows that the probability of measuring the state \|0⟩ results in 0
is 1, which is certain.

The [Bloch sphere](https://en.wikipedia.org/wiki/Bloch_sphere) is a
geometrical representation of quantum states. We can visualize the
quantum state \|0⟩ as a vector on the Bloch sphere.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg state/|0⟩))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="210.0" y1="210" y2="102.47999999999999"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="210.0" y1="210" y2="102.47999999999999"></line><circle cx="210.0" cy="102.47999999999999" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=0.0°, φ=0.0°
Bloch Vector: (0.0, 0.0, 1.0)
State: 1.0+0.0i |0⟩ + 0.0+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="224.0" y="88.47999999999999">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (0.0, 0.0, 1.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=0.0°, φ=0.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 1.0+0.0i |0⟩ + 0.0+0.0i |1⟩</text></g></svg>

The Bloch sphere representation shows that the state \|0⟩ is at the
north pole of the sphere.

Let’s look at another quantum state, the excited state \|1⟩.

<div class="sourceClojure">

``` clojure
state/|1⟩
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[0.0 0.0] [1.0 0.0]], :num-qubits 1}
```

</div>

We can visualize the probability distribution of the quantum state \|1⟩.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg state/|1⟩))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.0" y2="204.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.0">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.0" y2="156.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.0">60%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.0" y2="108.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.0">80%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.0" y2="60.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.0">100%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="478" x="80" y="60.0"><title>|1⟩: 100.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="320" y="320">|1⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="320" y="55.0">100.0%</text></g></svg>

It shows that the probability of measuring the state \|1⟩ results in 1
is 1, which is also certain. The Bloch sphere representation shows that
the state \|1⟩ is at the south pole of the sphere.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg state/|1⟩))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="210.00000000000003" y1="210" y2="317.52"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="210.00000000000003" y1="210" y2="317.52"></line><circle cx="210.00000000000003" cy="317.52" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=180.0°, φ=0.0°
Bloch Vector: (0.0, 0.0, -1.0)
State: 0.0+0.0i |0⟩ + 1.0+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="224.00000000000003" y="303.52">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (0.0, 0.0, -1.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=180.0°, φ=0.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 0.0+0.0i |0⟩ + 1.0+0.0i |1⟩</text></g></svg>

### Superposition States

Quantum states can also be in a superposition of the ground and excited
states. Superposition states are linear combinations of the basic
quantum states.

Let’s look at the quantum state \|+⟩, which is a superposition of the
ground and excited states. The state \|+⟩ is defined as (\|0⟩ + \|1⟩) /
√2.

<div class="sourceClojure">

``` clojure
state/|+⟩
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[0.7071067811865475 0.0] [0.7071067811865475 0.0]],
 :num-qubits 1}
```

</div>

We can visualize the probability distribution of the quantum state \|+⟩.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg state/|+⟩))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|0⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|0⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|1⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|1⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The Bloch sphere representation shows that the state \|+⟩ is on the
equator of the sphere, which means, that the probabilities for measuring
0 or 1 are the same.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg state/|+⟩))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><circle cx="326.39381426862855" cy="142.8" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=90.0°, φ=0.0°
Bloch Vector: (1.0, 0.0, 0.0)
State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="340.39381426862855" y="128.8">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (1.0, 0.0, 0.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=90.0°, φ=0.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</text></g></svg>

The quantum state \|-⟩ is another superposition of the ground and
excited states. The state \|-⟩ is defined as (\|0⟩ - \|1⟩) / √2.

<div class="sourceClojure">

``` clojure
state/|-⟩
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[0.7071067811865475 0.0] [-0.7071067811865475 0.0]],
 :num-qubits 1}
```

</div>

We can visualize the probability distribution of the quantum state \|-⟩.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg state/|-⟩))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|0⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|0⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|1⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|1⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The Bloch sphere representation shows that the state \|-⟩ is also on the
equator of the sphere, but pointing in the opposite direction.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg state/|-⟩))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="93.60618573137141" y1="210" y2="277.2"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="93.60618573137141" y1="210" y2="277.2"></line><circle cx="93.60618573137141" cy="277.2" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=90.0°, φ=180.0°
Bloch Vector: (-1.0, 0.0, 0.0)
State: 0.707+0.0i |0⟩ + -0.707+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="107.60618573137141" y="263.2">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (-1.0, 0.0, 0.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=90.0°, φ=180.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 0.707+0.0i |0⟩ + -0.707+0.0i |1⟩</text></g></svg>

### Multi-Qubit States and Quantum Registers

Tensor products can be used to create multi-qubit states from
single-qubit states. For example, the state \|00⟩ is the tensor product
of two \|0⟩ states.

<div class="sourceClojure">

``` clojure
state/|00⟩
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[1.0 0.0] [0.0 0.0] [0.0 0.0] [0.0 0.0]], :num-qubits 2}
```

</div>

We can visualize the probability distribution of the quantum state
\|00⟩.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg state/|00⟩))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (2 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.0" y2="204.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.0">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.0" y2="156.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.0">60%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.0" y2="108.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.0">80%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.0" y2="60.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.0">100%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="478" x="80" y="60.0"><title>|00⟩: 100.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="320" y="320">|00⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="320" y="55.0">100.0%</text></g></svg>

## Quantum Gates

Quantum gates are operations that can be applied to quantum states. They
are represented as matrices that act on the quantum states. The *qg*
namespace defines several quantum gates.

### Pauli Gates

The [Pauli gates](https://en.wikipedia.org/wiki/Pauli_matrices) are a
set of quantum gates that can be applied to single qubits.

The Pauli-X gate is a quantum gate that flips the state of a qubit
around the X axis which swaps the amplitudes of \|0⟩ and \|1⟩.

<div class="sourceClojure">

``` clojure
gate/pauli-x
```

</div>

<div class="printedClojure">

``` clojure
[[[0.0 0.0] [1.0 0.0]] [[1.0 0.0] [0.0 0.0]]]
```

</div>

The Pauli-Y gate is a quantum gate that flips the state of a qubit
around the Y axis which swaps the amplitudes of \|0⟩ and \|1⟩ and also
adds a phase.

<div class="sourceClojure">

``` clojure
gate/pauli-y
```

</div>

<div class="printedClojure">

``` clojure
[[[0.0 0.0] [0.0 -1.0]] [[0.0 1.0] [0.0 0.0]]]
```

</div>

The Pauli-Z gate is a quantum gate that flips the state of a qubit
around the Y axis which adds a phase to the state of a qubit.

<div class="sourceClojure">

``` clojure
gate/pauli-z
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0]] [[0.0 0.0] [-1.0 0.0]]]
```

</div>

The Pauli gates are self inverse, applying the same gate twice results
in the original value.

### Hadamard Gate

The [Hadamard gate](https://en.wikipedia.org/wiki/Hadamard_gate) is a
quantum gate that creates superposition states. It transforms the state
\|0⟩ into the state \|+⟩ and \|1⟩ into the state \|-⟩. The Hadamard gate
is defined as the matrix:

<div class="sourceClojure">

``` clojure
gate/hadamard
```

</div>

<div class="printedClojure">

``` clojure
[[[0.7071067811865475 0.0] [0.7071067811865475 0.0]]
 [[0.7071067811865475 0.0] [-0.7071067811865475 0.0]]]
```

</div>

We can apply the Hadamard gate to the state \|0⟩ to create the
superposition state \|+⟩.

<div class="sourceClojure">

``` clojure
(def hadamard-state
  (gate/h-gate state/|0⟩))
```

</div>

We can visualize the probability distribution of the Hadamard state.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg hadamard-state))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|0⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|0⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|1⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|1⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The probability distribution shows that the Hadamard state is in a
superposition of the ground and excited states.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg hadamard-state))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><circle cx="326.39381426862855" cy="142.8" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=90.0°, φ=0.0°
Bloch Vector: (1.0, 0.0, 0.0)
State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="340.39381426862855" y="128.8">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (1.0, 0.0, 0.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=90.0°, φ=0.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</text></g></svg>

The Bloch sphere representation shows that the Hadamard state is on the
equator of the sphere.

The Hadamard gate is also self inverse, resulting in the input state
again if applied twice.

### Phase Gates

Phase gates are quantum gates that add a phase to the state of a qubit.

The [S gate](https://en.wikipedia.org/wiki/S_gate) is a phase gate that
adds a phase of π/2 to the state of a qubit.

<div class="sourceClojure">

``` clojure
gate/s-gate
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0]] [[0.0 0.0] [0.0 1.0]]]
```

</div>

The [S† gate](https://en.wikipedia.org/wiki/S_gate#S%E2%81%BF_gate) is
the inverse of the S gate and adds a phase of -π/2 to the state of a
qubit.

<div class="sourceClojure">

``` clojure
gate/s-dag-gate
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0]] [[0.0 0.0] [0.0 -1.0]]]
```

</div>

The [T gate](https://en.wikipedia.org/wiki/T_gate) is a phase gate that
adds a phase of π/4 to the state of a qubit.

<div class="sourceClojure">

``` clojure
gate/t-gate
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0]]
 [[0.0 0.0] [0.7071067811865476 0.7071067811865475]]]
```

</div>

The [T† gate](https://en.wikipedia.org/wiki/T_gate#T%E2%81%BF_gate) is
the inverse of the T gate and adds a phase of -π/4 to the state of a
qubit.

<div class="sourceClojure">

``` clojure
gate/t-dag-gate
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0]]
 [[0.0 0.0] [0.7071067811865476 -0.7071067811865475]]]
```

</div>

### Rotation Gates

Rotation gates are quantum gates that rotate the state of a qubit around
the Bloch sphere.

The [RX gate](https://en.wikipedia.org/wiki/Rotation_gate#RX_gate) is a
rotation gate that rotates the state of a qubit around the X axis of the
Bloch sphere.

<div class="sourceClojure">

``` clojure
(gate/rx-gate fm/-QUARTER_PI)
```

</div>

<div class="printedClojure">

``` clojure
[[[0.9238795325112867 0.0] [0.0 0.3826834323650898]]
 [[0.0 0.3826834323650898] [0.9238795325112867 0.0]]]
```

</div>

The [RY gate](https://en.wikipedia.org/wiki/Rotation_gate#RY_gate) is a
rotation gate that rotates the state of a qubit around the Y axis of the
Bloch sphere.

<div class="sourceClojure">

``` clojure
(gate/ry-gate fm/-QUARTER_PI)
```

</div>

<div class="printedClojure">

``` clojure
[[[0.9238795325112867 0.0] [0.3826834323650898 0.0]]
 [[-0.3826834323650898 0.0] [0.9238795325112867 0.0]]]
```

</div>

The [RZ gate](https://en.wikipedia.org/wiki/Rotation_gate#RZ_gate) is a
rotation gate that rotates the state of a qubit around the Z axis of the
Bloch sphere.

<div class="sourceClojure">

``` clojure
(gate/rz-gate fm/-QUARTER_PI)
```

</div>

<div class="printedClojure">

``` clojure
[[[0.9238795325112867 0.3826834323650898] [0.0 0.0]]
 [[0.0 0.0] [0.9238795325112867 -0.3826834323650898]]]
```

</div>

### Controlled Gates

Controlled gates are quantum gates that act on multiple qubits. They are
defined as a combination of a control qubit and a target qubit. The
control qubit determines whether the target qubit is affected by the
gate.

The controlled-X gate ([CNOT
gate](https://en.wikipedia.org/wiki/CNOT_gate)) is a controlled gate
that flips the state of the target qubit if the control qubit is in the
state \|1⟩.

<div class="sourceClojure">

``` clojure
(gate/cnot-gate)
```

</div>

<div class="printedClojure">

``` clojure
[[[1.0 0.0] [0.0 0.0] [0.0 0.0] [0.0 0.0]]
 [[0.0 0.0] [1.0 0.0] [0.0 0.0] [0.0 0.0]]
 [[0.0 0.0] [0.0 0.0] [0.0 0.0] [1.0 0.0]]
 [[0.0 0.0] [0.0 0.0] [1.0 0.0] [0.0 0.0]]]
```

</div>

The controlled-Y gate is a controlled gate that flips the state of the
target qubit and adds a phase if the control qubit is in the state \|1⟩.

The controlled-Z gate is a controlled gate that adds a phase to the
target qubit if the control qubit is in the state \|1⟩.

## Quantum Circuits

Quantum circuits are sequences of quantum gates applied to quantum
states. The *qc* namespace provides functions to create and manipulate
quantum circuits.

### Creating a Quantum Circuit

We can create a simple quantum circuit that applies the Hadamard gate to
the state \|0⟩.

<div class="sourceClojure">

``` clojure
(def simple-circuit
  (-> (circuit/create-circuit 1 "Hadamard on qubit 0")
      (circuit/h-gate 0)))
```

</div>

We can visualize the quantum circuit.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg simple-circuit))
```

</div>

<svg height="160" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="300" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="150" y="35">Hadamard on qubit 0</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="250" y1="70" y2="70"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="255" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="270" y="75">M</text><title>Measure qubit 0</title></g><g><text fill="#6b7280" font-size="12" x="30" y="130">Qubits: 1 | Gates: 1 | Depth: 1</text></g></svg>

The circuit shows that the Hadamard gate is applied to the qubit 0.

We can execute the circuit with the `qc/execute-circuit` function on the
state \|0⟩ to create the Hadamard state.

<div class="sourceClojure">

``` clojure
(def hadamard-circuit-result
  (circuit/execute-circuit simple-circuit state/|0⟩))
```

</div>

We can visualize the probability distribution of the Hadamard circuit
state.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (:final-state hadamard-circuit-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (1 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|0⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|0⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|1⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|1⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The probability distribution shows that the Hadamard circuit state is in
a superposition of the ground and excited states. It is the same as the
Hadamard state we created earlier, but now created by a quantum circuit,
not just the application of a single gate on a quantum state.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-bloch-sphere :svg (:final-state hadamard-circuit-result)))
```

</div>

<svg height="420" style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><ellipse cx="210" cy="210" fill="#475569" opacity="0.2" rx="134.4" ry="77.5488"></ellipse><path d="M 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999 L 210.0,102.47999999999999" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,83.97084005443199 L 249.67868228576222,78.84283735381581 L 237.33115171831682,75.03238759047659 L 223.93330031782295,72.68592421189456 L 210.0,71.8936204897968 L 196.06669968217705,72.68592421189453 L 182.6688482816832,75.03238759047659 L 170.32131771423778,78.84283735381581 L 159.49861665497284,83.97084005443199 L 150.6166554361552,90.21932942435744 L 144.01676284636284,97.34817952129917 L 139.95256905655904,105.0834326339369 L 138.58025875485984,113.1278273231319 L 139.952569056559,121.17222201232688 L 144.01676284636284,128.9074751249646 L 150.6166554361552,136.03632522190634 L 159.4986166549728,142.28481459183178 L 170.3213177142378,147.41281729244798 L 182.66884828168318,151.2232670557872 L 196.06669968217702,153.56973043436923 L 209.99999999999997,154.36203415646696 L 223.93330031782295,153.56973043436923 L 237.3311517183168,151.22326705578723 L 249.67868228576216,147.41281729244798 L 260.5013833450272,142.2848145918318 L 269.3833445638448,136.03632522190634 L 275.98323715363716,128.90747512496458 L 280.047430943441,121.17222201232691 L 281.41974124514013,113.12782732313191 L 280.047430943441,105.08343263393691 L 275.98323715363716,97.34817952129919 L 269.3833445638448,90.21932942435744 L 260.5013833450272,83.97084005443199" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.0003483597504,90.42330088229738 L 281.49851491772586,81.18295930674799 L 259.2490336442423,74.31676608779838 L 235.10693962698673,70.08858518024735 L 210.00000000000003,68.6609032051808 L 184.8930603730133,70.08858518024732 L 160.75096635575773,74.31676608779838 L 138.50148508227412,81.18295930674799 L 118.99965164024961,90.42330088229738 L 102.99491055210702,101.68268966974148 L 91.10231504230143,114.52843367231675 L 83.77889088683028,128.4668781519805 L 81.30607316896476,142.96237650414895 L 83.77889088683027,157.45787485631746 L 91.1023150423014,171.39631933598116 L 102.994910552107,184.24206333855645 L 118.9996516402496,195.50145212600054 L 138.50148508227414,204.74179370154997 L 160.75096635575767,211.60798692049954 L 184.89306037301324,215.8361678280506 L 209.99999999999997,217.26384980311715 L 235.10693962698673,215.8361678280506 L 259.2490336442423,211.60798692049954 L 281.4985149177258,204.74179370155 L 301.0003483597504,195.50145212600057 L 317.005089447893,184.24206333855648 L 328.89768495769863,171.39631933598116 L 336.2211091131697,157.4578748563175 L 338.69392683103524,142.962376504149 L 336.22110911316975,128.4668781519805 L 328.89768495769863,114.52843367231678 L 317.005089447893,101.68268966974148 L 301.00034835975043,90.4233008822974" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,120.55939348239853 L 299.1571897984932,109.03687600630592 L 271.41254045716545,100.47487310709259 L 241.30784162661828,95.20241775454879 L 210.00000000000003,93.42212745104577 L 178.69215837338174,95.20241775454879 L 148.58745954283455,100.47487310709259 L 120.84281020150678,109.03687600630592 L 96.524421664207,120.55939348239853 L 76.5668359645143,134.59962165066645 L 61.737011928524794,150.6180024164538 L 52.604851377280454,167.99895839014283 L 49.52129811939096,186.07454918101703 L 52.604851377280454,204.1501399718913 L 61.737011928524765,221.5310959455803 L 76.56683596451427,237.54947671136765 L 96.52442166420698,251.58970487963558 L 120.8428102015068,263.11222235572825 L 148.5874595428345,271.6742252549415 L 178.6921583733817,276.9466806074853 L 209.99999999999994,278.72697091098837 L 241.30784162661828,276.9466806074853 L 271.4125404571654,271.6742252549415 L 299.1571897984931,263.11222235572825 L 323.475578335793,251.5897048796356 L 343.43316403548573,237.54947671136767 L 358.2629880714752,221.53109594558026 L 367.3951486227195,204.15013997189135 L 370.47870188060904,186.0745491810171 L 367.39514862271955,167.99895839014283 L 358.2629880714752,150.61800241645386 L 343.43316403548573,134.59962165066645 L 323.47557833579305,120.55939348239855" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 323.475578335793,168.41029512036437 L 299.1571897984932,156.88777764427175 L 271.41254045716545,148.32577474505845 L 241.30784162661828,143.05331939251465 L 210.00000000000003,141.27302908901163 L 178.69215837338174,143.05331939251465 L 148.58745954283455,148.32577474505842 L 120.84281020150678,156.88777764427175 L 96.524421664207,168.41029512036437 L 76.5668359645143,182.4505232886323 L 61.737011928524794,198.46890405441968 L 52.604851377280454,215.84986002810868 L 49.52129811939096,233.92545081898288 L 52.604851377280454,252.00104160985717 L 61.737011928524765,269.38199758354614 L 76.56683596451427,285.4003783493335 L 96.52442166420698,299.44060651760145 L 120.8428102015068,310.96312399369407 L 148.5874595428345,319.5251268929074 L 178.6921583733817,324.79758224545117 L 209.99999999999994,326.57787254895425 L 241.30784162661828,324.79758224545117 L 271.4125404571654,319.5251268929074 L 299.1571897984931,310.9631239936941 L 323.475578335793,299.44060651760145 L 343.43316403548573,285.40037834933355 L 358.2629880714752,269.3819975835461 L 367.3951486227195,252.00104160985723 L 370.47870188060904,233.92545081898294 L 367.39514862271955,215.8498600281087 L 358.2629880714752,198.4689040544197 L 343.43316403548573,182.4505232886323 L 323.47557833579305,168.4102951203644" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 301.00034835975043,224.49854787399943 L 281.4985149177259,215.25820629845003 L 259.2490336442423,208.39201307950043 L 235.10693962698673,204.1638321719494 L 210.0,202.73615019688285 L 184.8930603730133,204.16383217194937 L 160.75096635575773,208.39201307950043 L 138.50148508227412,215.25820629845003 L 118.9996516402496,224.49854787399943 L 102.994910552107,235.75793666144352 L 91.1023150423014,248.6036806640188 L 83.77889088683027,262.54212514368254 L 81.30607316896476,277.037623495851 L 83.77889088683024,291.5331218480195 L 91.10231504230138,305.47156632768326 L 102.99491055210699,318.3173103302585 L 118.99965164024958,329.5766991177026 L 138.50148508227412,338.817040693252 L 160.75096635575767,345.6832339122016 L 184.89306037301324,349.9114148197527 L 209.99999999999994,351.3390967948192 L 235.10693962698673,349.9114148197527 L 259.2490336442423,345.6832339122016 L 281.4985149177258,338.81704069325207 L 301.0003483597504,329.5766991177026 L 317.005089447893,318.3173103302585 L 328.89768495769863,305.4715663276832 L 336.22110911316975,291.53312184801956 L 338.69392683103524,277.03762349585105 L 336.22110911316975,262.5421251436826 L 328.89768495769863,248.60368066401884 L 317.005089447893,235.75793666144352 L 301.00034835975043,224.49854787399946" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 260.5013833450272,277.7151854081682 L 249.67868228576222,272.587182707552 L 237.33115171831682,268.77673294421277 L 223.93330031782295,266.43026956563074 L 210.0,265.63796584353304 L 196.06669968217705,266.43026956563074 L 182.6688482816832,268.77673294421277 L 170.32131771423778,272.587182707552 L 159.49861665497284,277.7151854081682 L 150.6166554361552,283.96367477809366 L 144.01676284636284,291.0925248750354 L 139.95256905655904,298.82777798767313 L 138.58025875485984,306.8721726768681 L 139.952569056559,314.9165673660631 L 144.01676284636284,322.6518204787008 L 150.6166554361552,329.78067057564255 L 159.4986166549728,336.02915994556804 L 170.3213177142378,341.1571626461842 L 182.66884828168318,344.96761240952344 L 196.06669968217702,347.31407578810547 L 209.99999999999997,348.10637951020317 L 223.93330031782295,347.31407578810547 L 237.3311517183168,344.96761240952344 L 249.67868228576216,341.1571626461842 L 260.5013833450272,336.02915994556804 L 269.3833445638448,329.78067057564255 L 275.98323715363716,322.6518204787008 L 280.047430943441,314.91656736606313 L 281.41974124514013,306.8721726768681 L 280.047430943441,298.82777798767313 L 275.98323715363716,291.0925248750354 L 269.3833445638448,283.96367477809366 L 260.5013833450272,277.7151854081682" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.00000000000003,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 210.0,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52 L 209.99999999999997,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.0,317.52000000000004 L 210.00000000000003,317.52000000000004 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,96.4109863580589 L 232.70730670635217,91.43589701156084 L 243.78734080938466,87.60264479057304 L 254.54198435038353,84.94814600945242 L 264.86766423296274,83.49796494255783 L 274.6649385152623,83.26606762631306 L 283.8394540902086,84.25468735864153 L 292.3028553575148,86.45430319108641 L 299.97363513641073,89.84373162074893 L 306.77791962435106,94.39033059900132 L 312.6501798421165,100.05031389225928 L 317.53386271370607,106.76917276734707 L 321.3819357033738,114.48220094039578 L 324.1573397646584,123.11511773372881 L 325.8333462392596,132.58478343939402 L 326.39381426862855,142.8 L 325.8333462392596,153.66238929586274 L 324.1573397646584,165.06734058007703 L 321.38193570337376,176.90501793719537 L 317.53386271370607,189.061418063136 L 312.6501798421165,201.41946817932183 L 306.77791962435106,213.86015350753658 L 299.9736351364108,226.26366344729922 L 292.30285535751483,238.51054541744156 L 283.8394540902086,250.48285524976453 L 274.66493851526224,262.06529305585246 L 264.8676642329628,273.14631362802805 L 254.5419843503836,283.6192006806795 L 243.7873408093847,293.3830945864272 L 232.7073067063522,302.3439637094715 L 221.40858882666097,310.41550998164814 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,93.68266441802643 L 210.0,86.00552836323088 L 210.0,79.52252685257048 L 210.0,74.29609473456202 L 210.0,70.37656540756032 L 210.0,67.80168608161708 L 210.00000000000003,66.59625425221336 L 210.00000000000003,66.7718788868224 L 210.0,68.32686862420672 L 210.00000000000003,71.24624806315148 L 210.0,75.50190198376441 L 210.00000000000003,81.05284611241305 L 210.00000000000003,87.84562182268373 L 210.00000000000003,95.81481097117758 L 210.00000000000003,104.88366590999274 L 210.00000000000003,114.96484860852802 L 210.00000000000003,125.96127176646148 L 210.00000000000003,137.76703381752583 L 210.0,150.2684388194833 L 210.00000000000003,163.34509140820197 L 210.00000000000003,176.87105627082698 L 210.0,190.71607097168672 L 210.00000000000003,204.74680045075704 L 210.0,218.8281211131776 L 210.00000000000003,232.82442214333634 L 210.0,246.60091151115645 L 210.0,260.02491409303053 L 210.0,272.9671494057891 L 210.0,285.3029766484247 L 210.0,296.91359506114156 L 210.0,307.6871880416157 L 210.0,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,96.4109863580589 L 187.29269329364783,91.43589701156084 L 176.21265919061534,87.60264479057304 L 165.45801564961647,84.94814600945242 L 155.13233576703726,83.49796494255783 L 145.33506148473774,83.26606762631306 L 136.16054590979135,84.25468735864153 L 127.69714464248521,86.45430319108641 L 120.02636486358924,89.84373162074893 L 113.22208037564896,94.39033059900132 L 107.3498201578835,100.05031389225928 L 102.4661372862939,106.76917276734707 L 98.6180642966262,114.48220094039577 L 95.84266023534161,123.1151177337288 L 94.16665376074043,132.58478343939402 L 93.60618573137144,142.8 L 94.16665376074043,153.66238929586274 L 95.84266023534161,165.06734058007703 L 98.61806429662622,176.90501793719534 L 102.4661372862939,189.061418063136 L 107.3498201578835,201.41946817932183 L 113.22208037564894,213.86015350753658 L 120.0263648635892,226.26366344729922 L 127.69714464248518,238.51054541744156 L 136.16054590979135,250.48285524976453 L 145.33506148473776,262.06529305585246 L 155.1323357670372,273.14631362802805 L 165.4580156496164,283.6192006806795 L 176.2126591906153,293.3830945864272 L 187.2926932936478,302.3439637094715 L 198.59141117333903,310.41550998164814 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 193.86581895379788,102.99773818820537 L 177.88701889091124,104.54596665104465 L 162.21748439084624,107.1097751020729 L 147.00812163667746,110.66447266438642 L 132.4054051060109,115.17582565726484 L 118.54996694169378,120.60038728523031 L 105.5752425874014,126.8859160544385 L 93.60618573137145,133.97187888682237 L 82.75806493407946,141.7900340867248 L 73.13535352898944,150.26508854573234 L 64.83072348724156,159.3154228564687 L 57.92415293591037,168.8538773521055 L 52.48215592492073,178.7885915016002 L 48.55714186038671,189.02388857682584 L 46.18691077338056,199.4611970717656 L 45.3942892849704,209.99999999999997 L 46.18691077338056,220.53880292823433 L 48.55714186038671,230.97611142317407 L 52.48215592492076,241.21140849839975 L 57.92415293591037,251.14612264789443 L 64.83072348724156,260.68457714353127 L 73.13535352898941,269.7349114542676 L 82.75806493407941,278.20996591327514 L 93.60618573137141,286.0281211131776 L 105.5752425874014,293.11408394556145 L 118.54996694169381,299.39961271476966 L 132.40540510601085,304.8241743427351 L 147.0081216366774,309.33552733561356 L 162.21748439084624,312.89022489792706 L 177.88701889091118,315.45403334895536 L 193.86581895379788,317.0022618117946 L 209.99999999999997,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 198.59141117333903,109.58449001835186 L 187.29269329364783,117.65603629052846 L 176.2126591906153,126.61690541357277 L 165.45801564961647,136.38079931932046 L 155.13233576703723,146.8536863719719 L 145.3350614847377,157.9347069441476 L 136.16054590979132,169.51714475023547 L 127.6971446424852,181.48945458255838 L 120.02636486358922,193.73633655270072 L 113.22208037564894,206.13984649246336 L 107.34982015788347,218.58053182067815 L 102.46613728629389,230.93858193686398 L 98.61806429662619,243.09498206280463 L 95.8426602353416,254.93265941992294 L 94.16665376074042,266.33761070413726 L 93.60618573137141,277.2 L 94.16665376074042,287.415216560606 L 95.8426602353416,296.8848822662712 L 98.6180642966262,305.5177990596042 L 102.46613728629389,313.2308272326529 L 107.34982015788347,319.9496861077407 L 113.22208037564893,325.60966940099865 L 120.02636486358918,330.15626837925106 L 127.69714464248517,333.5456968089136 L 136.16054590979132,335.74531264135845 L 145.33506148473774,336.7339323736869 L 155.1323357670372,336.5020350574422 L 165.4580156496164,335.0518539905476 L 176.2126591906153,332.39735520942696 L 187.2926932936478,328.5641029884392 L 198.59141117333903,323.5890136419411 L 209.99999999999997,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 210.0,112.31281195838433 L 210.0,123.08640493885842 L 210.0,134.6970233515753 L 209.99999999999997,147.03285059421086 L 209.99999999999997,159.9750859069694 L 209.99999999999997,173.39908848884357 L 209.99999999999997,187.17557785666366 L 209.99999999999997,201.17187888682238 L 209.99999999999997,215.2531995492429 L 209.99999999999997,229.28392902831325 L 209.99999999999994,243.12894372917302 L 209.99999999999994,256.654908591798 L 209.99999999999994,269.7315611805167 L 209.99999999999994,282.2329661824742 L 209.99999999999994,294.03872823353856 L 209.99999999999994,305.03515139147197 L 209.99999999999994,315.1163340900073 L 209.99999999999994,324.1851890288224 L 209.99999999999994,332.1543781773163 L 209.99999999999994,338.947153887587 L 209.99999999999994,344.4980980162356 L 209.99999999999997,348.7537519368485 L 209.99999999999997,351.6731313757933 L 209.99999999999997,353.22812111317756 L 209.99999999999997,353.4037457477866 L 209.99999999999997,352.19831391838295 L 209.99999999999997,349.6234345924397 L 209.99999999999997,345.70390526543804 L 209.99999999999997,340.4774731474295 L 210.0,333.99447163676916 L 210.0,326.31733558197357 L 210.0,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 221.40858882666097,109.58449001835186 L 232.70730670635217,117.65603629052846 L 243.78734080938466,126.61690541357277 L 254.54198435038353,136.3807993193205 L 264.86766423296274,146.8536863719719 L 274.66493851526224,157.9347069441476 L 283.8394540902086,169.5171447502355 L 292.3028553575148,181.48945458255838 L 299.97363513641073,193.73633655270075 L 306.77791962435106,206.1398464924634 L 312.6501798421165,218.58053182067817 L 317.53386271370607,230.938581936864 L 321.38193570337376,243.09498206280466 L 324.1573397646584,254.93265941992297 L 325.8333462392595,266.33761070413726 L 326.39381426862855,277.2 L 325.8333462392595,287.415216560606 L 324.1573397646584,296.8848822662712 L 321.38193570337376,305.5177990596042 L 317.53386271370607,313.2308272326529 L 312.6501798421165,319.9496861077407 L 306.77791962435106,325.60966940099865 L 299.9736351364108,330.15626837925106 L 292.3028553575148,333.5456968089136 L 283.8394540902086,335.74531264135845 L 274.66493851526224,336.73393237368697 L 264.8676642329628,336.5020350574422 L 254.54198435038356,335.0518539905476 L 243.78734080938466,332.39735520942696 L 232.7073067063522,328.5641029884392 L 221.40858882666097,323.5890136419411 L 210.00000000000003,317.52000000000004" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><path d="M 210.0,102.47999999999999 L 226.13418104620212,102.99773818820537 L 242.11298110908876,104.54596665104465 L 257.78251560915373,107.10977510207292 L 272.99187836332254,110.66447266438645 L 287.5945948939891,115.17582565726487 L 301.45003305830625,120.60038728523035 L 314.4247574125986,126.88591605443852 L 326.39381426862855,133.97187888682242 L 337.24193506592053,141.79003408672486 L 346.86464647101053,150.2650885457324 L 355.1692765127584,159.31542285646876 L 362.07584706408966,168.85387735210557 L 367.51784407507927,178.78859150160025 L 371.44285813961335,189.02388857682593 L 373.81308922661947,199.46119707176567 L 374.6057107150296,210.00000000000003 L 373.81308922661947,220.53880292823442 L 371.44285813961335,230.97611142317413 L 367.5178440750792,241.2114084983998 L 362.07584706408966,251.1461226478945 L 355.1692765127584,260.6845771435313 L 346.8646464710106,269.73491145426766 L 337.2419350659206,278.20996591327514 L 326.3938142686286,286.0281211131776 L 314.4247574125986,293.1140839455615 L 301.4500330583062,299.3996127147697 L 287.59459489398915,304.82417434273515 L 272.9918783633226,309.33552733561356 L 257.7825156091538,312.8902248979271 L 242.11298110908882,315.45403334895536 L 226.13418104620212,317.0022618117946 L 210.00000000000003,317.52" fill="none" opacity="0.8" stroke="#475569" stroke-width="1.4"></path><line stroke="#ef4444" stroke-width="2" x1="70.32742287764572" x2="349.67257712235426" y1="290.64" y2="129.36"></line><line stroke="#22c55e" stroke-width="2" x1="349.67257712235426" x2="70.32742287764572" y1="290.64" y2="129.36"></line><line stroke="#3b82f6" stroke-width="2" x1="210.0" x2="210.0" y1="339.024" y2="80.976"></line><text fill="#ef4444" font-size="14" font-weight="bold" text-anchor="middle" x="372.95133997608" y="115.92000000000002">X</text><text fill="#22c55e" font-size="14" font-weight="bold" text-anchor="middle" x="47.04866002392001" y="115.92000000000002">Y</text><text fill="#3b82f6" font-size="14" font-weight="bold" text-anchor="middle" x="210.0" y="59.47200000000001">Z</text><g><circle cx="210.0" cy="102.47999999999999" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="105.47999999999999">|0⟩</text></g><g><circle cx="210.0" cy="317.52" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="218.0" y="320.52">|1⟩</text></g><g><circle cx="326.39381426862855" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="145.8">|+⟩</text></g><g><circle cx="93.60618573137144" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="280.2">|-⟩</text></g><g><circle cx="93.60618573137144" cy="142.8" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="101.60618573137144" y="145.8">|+i⟩</text></g><g><circle cx="326.39381426862855" cy="277.2" fill="#9ca3af" r="3" stroke="#ffffff" stroke-width="1"></circle><text fill="#6b7280" font-size="10" x="334.39381426862855" y="280.2">|-i⟩</text></g><g><line opacity="0.9" stroke="#4c1d95" stroke-width="4" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><line opacity="1" stroke="#7c3aed" stroke-width="2.5" x1="210" x2="326.39381426862855" y1="210" y2="142.8"></line><circle cx="326.39381426862855" cy="142.8" fill="#7c3aed" r="8" stroke="#ffffff" stroke-width="3"><title>Current State: θ=90.0°, φ=0.0°
Bloch Vector: (1.0, 0.0, 0.0)
State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</title></circle><text fill="#4c1d95" font-size="18" font-weight="bold" paint-order="stroke" stroke="#ffffff" stroke-width="0.8" x="340.39381426862855" y="128.8">ψ</text></g><g><text fill="#374151" font-size="12" x="20" y="370">Bloch Vector: (1.0, 0.0, 0.0)</text><text fill="#374151" font-size="12" x="20" y="385">Coordinates: θ=90.0°, φ=0.0°</text><text fill="#374151" font-size="12" x="20" y="400">State: 0.707+0.0i |0⟩ + 0.707+0.0i |1⟩</text></g></svg>

The *qc* namespace also has some predefined circuits.

For example, the ‘qc/bell-state-circuit’ creates a circuit that prepares
Bell state, which is a two-qubit entangled state.

<div class="sourceClojure">

``` clojure
(def bell-circuit
  (circuit/bell-state-circuit))
```

</div>

We can visualize the Bell circuit.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg bell-circuit))
```

</div>

<svg height="220" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="360" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="180" y="35">Bell State</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="310" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="310" y1="130" y2="130"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><circle cx="190" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="190" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="182" x2="198" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="315" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="330" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="315" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="330" y="135">M</text><title>Measure qubit 1</title></g><g><text fill="#6b7280" font-size="12" x="30" y="190">Qubits: 2 | Gates: 2 | Depth: 2</text><text fill="#6b7280" font-size="12" x="30" y="205">Prepares (|00⟩ + |11⟩)/√2</text></g></svg>

The Bell circuit shows that the Hadamard gate is applied to the first
qubit, followed by a CNOT gate between the first and second qubits. The
Bell state is a two-qubit state that is
[entangled](https://en.wikipedia.org/wiki/Entanglement).

<div class="sourceClojure">

``` clojure
(def bell-result
  (circuit/execute-circuit bell-circuit (state/zero-state 2)))
```

</div>

We can visualize the probability distribution of the Bell state.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (:final-state bell-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (2 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|00⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|00⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|11⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|11⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The *qc* namespace also has a predefined circuit for multi-qubit states.
This circuit can be used to create entangled states with more than two
qubits.

For example, the `qc/ghz-circuit` creates a circuit that prepares a
Greenberger-Horne-Zeilinger
([GHZ](https://en.wikipedia.org/wiki/Greenberger%E2%80%93Horne%E2%80%93Zeilinger_state))
state.

<div class="sourceClojure">

``` clojure
(def ghz-circuit
  (circuit/ghz-state-circuit 3))
```

</div>

We can visualize the GHZ circuit.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg ghz-circuit))
```

</div>

<svg height="280" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="210" y="35">GHZ State</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="370" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="370" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="370" y1="190" y2="190"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><circle cx="190" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="190" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="182" x2="198" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="375" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="390" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="375" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="390" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="375" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="390" y="195">M</text><title>Measure qubit 2</title></g><g><text fill="#6b7280" font-size="12" x="30" y="250">Qubits: 3 | Gates: 3 | Depth: 3</text><text fill="#6b7280" font-size="12" x="30" y="265">Prepares 3-qubit GHZ state</text></g></svg>

The GHZ circuit shows that the Hadamard gate is applied to the first
qubit, followed by CNOT gates between the first and second qubits, and
between the first and third qubits. The GHZ state is a multi-qubit state
that is entangled.

We can apply the GHZ circuit to the state \|000⟩ to create the GHZ
state.

<div class="sourceClojure">

``` clojure
(def ghz-result
  (circuit/execute-circuit ghz-circuit (state/zero-state 3)))
```

</div>

We can visualize the probability distribution of the GHZ state.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (:final-state ghz-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (3 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999997" y2="203.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999997">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999997" y2="155.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999997">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999994" y2="107.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999994">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.99999999999994" y2="59.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.99999999999994">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|000⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|111⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|111⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The probability distribution shows that the GHZ state is in a
superposition of the states \|000⟩ and \|111⟩.

## Data Format and I/O

Sometimes we want to save quantum circuits or quantum states to disk or
read them from disk. This is especially useful if we want to share
quantum circuits or states with others or if we want to use quantum
circuits or states created in other quantum computing frameworks.

QClojure supports various input and output formats for quantum circuits
and quantum states. This allows users to easily import and export
quantum circuits and states between different quantum computing
frameworks and tools. The supported formats include: \* Extensible Data
Notation (EDN) \* JSON (JavaScript Object Notation) \* QASM (Quantum
Assembly Language)

Let’s import the I/O namespace providing the API for reading and writing
quantum circuits and quantum states.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.io :as io])
```

</div>

Now we define some test data to demonstrate the I/O capabilities. We
create a quantum circuit with medium complexity for import and export.

<div class="sourceClojure">

``` clojure
(def test-circuit
  (-> (circuit/create-circuit 3 "I/O Test Circuit" "A circuit with medium complexity")
      (circuit/h-gate 0)
      (circuit/cnot-gate 0 1)
      (circuit/t-gate 1)
      (circuit/cnot-gate 1 2)
      (circuit/measure-operation [0 1 2])))
```

</div>

## EDN Support

EDN (Extensible Data Notation) is a data format that is similar to JSON
but is more expressive and flexible. It is a subset of Clojure syntax
and is used for representing data structures in a human-readable format.
QClojure supports EDN format for importing and exporting quantum
circuits and quantum states.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.io.edn :as edn])
```

</div>

Let’s first write a simple quantum state to disk in EDN format.

<div class="sourceClojure">

``` clojure
(io/export-quantum-state :edn state/|+⟩ "export/plus-state.edn")
```

</div>

<div class="printedClojure">

``` clojure
nil
```

</div>

We can read the quantum state in EDN form back from disk.

<div class="sourceClojure">

``` clojure
(io/import-quantum-state :edn "export/plus-state.edn")
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[0.7071067811865475 0.0] [0.7071067811865475 0.0]],
 :num-qubits 1,
 :metadata {}}
```

</div>

## JSON Support

JSON (JavaScript Object Notation) is a lightweight data interchange
format that is easy for humans to read and write and easy for machines
to parse and generate. It is widely used for data exchange between web
applications and servers. QClojure supports JSON format for importing
and exporting quantum circuits and quantum states. To use JSON I/O
capabilities, we need to require the `io.json` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.io.json :as json])
```

</div>

The functions for JSON I/O are the same, just with the different format
keyword `:json`. Let’s write the same quantum state to disk in JSON
format.

<div class="sourceClojure">

``` clojure
(io/export-quantum-state :json state/|+⟩ "export/plus-state.json")
```

</div>

<div class="printedClojure">

``` clojure
nil
```

</div>

We can read the quantum state in JSON form back from disk.

<div class="sourceClojure">

``` clojure
(io/import-quantum-state :json "export/plus-state.json")
```

</div>

<div class="printedClojure">

``` clojure
{:state-vector [[0.7071067811865475 0.0] [0.7071067811865475 0.0]],
 :num-qubits 1,
 :metadata {}}
```

</div>

### OpenQASM Support

QASM (Quantum Assembly Language) is a low-level programming language
used to describe quantum circuits. It is a standard format for
representing quantum circuits and is supported by many quantum computing
frameworks. QASM allows us to define quantum gates, measurements, and
other operations in a text-based format that can be easily shared and
executed on different quantum computing platforms. QASM 3 for example is
used as the exchange format for quantum circuits by Amazon Braket. QASM
2 is supported by IBM Quantum and other quantum computing frameworks.

QClojure supports QASM 2 and QASM 3 formats, allowing users to import
and export quantum circuits in QASM format. It does not support quantum
states in QASM format, as QASM is primarily used for representing
quantum circuits.

Let’s require the QASM namespace to explore the QASM I/O capabilities.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.io.qasm :as qasm])
```

</div>

We can export the quantum circuit to QASM 2 format.

<div class="sourceClojure">

``` clojure
(io/export-quantum-circuit :qasm2 test-circuit "export/test-circuit-qasm2.qasm")
```

</div>

<div class="printedClojure">

``` clojure
nil
```

</div>

To see how the QASM 2 output looks like, we can read the file with
slurp.

<div class="sourceClojure">

``` clojure
^kind/code
(slurp "export/test-circuit-qasm2.qasm")
```

</div>

<div class="sourceClojure">

``` clojure
OPENQASM 2.0;
include "qelib1.inc";
qreg q[3];
creg c[3];

h q[0];
cx q[0],q[1];
t q[1];
cx q[1],q[2];
// Measurement will be handled by final measure statement
measure q -> c;
```

</div>

We can read the quantum circuit in QASM 2 format back from disk.

<div class="sourceClojure">

``` clojure
(io/import-quantum-circuit :qasm2 "export/test-circuit-qasm2.qasm")
```

</div>

<div class="printedClojure">

``` clojure
{:operations
 [{:operation-type :h, :operation-params {:target 0}}
  {:operation-type :cnot, :operation-params {:control 0, :target 1}}
  {:operation-type :t, :operation-params {:target 1}}
  {:operation-type :cnot, :operation-params {:control 1, :target 2}}],
 :num-qubits 3,
 :name "Converted Circuit"}
```

</div>

We can also export the quantum circuit to QASM 3 format.

<div class="sourceClojure">

``` clojure
(io/export-quantum-circuit :qasm3 test-circuit "export/test-circuit-qasm3.qasm")
```

</div>

<div class="printedClojure">

``` clojure
nil
```

</div>

To see how the QASM 3 output looks like, we can read the file with
slurp.

<div class="sourceClojure">

``` clojure
^kind/code
(slurp "export/test-circuit-qasm3.qasm")
```

</div>

<div class="sourceClojure">

``` clojure
OPENQASM 3.0;

qubit[3] q;
bit[3] c;

h q[0];
cx q[0], q[1];
t q[1];
cx q[1], q[2];
c[0] = measure q[0];
c[1] = measure q[1];
c[2] = measure q[2];
```

</div>

We can read the quantum circuit in QASM 3 format back from disk.

<div class="sourceClojure">

``` clojure
(io/import-quantum-circuit :qasm3 "export/test-circuit-qasm3.qasm")
```

</div>

<div class="printedClojure">

``` clojure
{:circuit
 {:operations
  [{:operation-type :h, :operation-params {:target 0}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :t, :operation-params {:target 1}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [0]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [1]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [2]}}],
  :num-qubits 3,
  :name "Converted Circuit"},
 :result-specs {}}
```

</div>

## Math Backends for Complex Linear Algebra

Simulating quantum circuits on a classical computer requires efficient
linear algebra operations on complex numbers. QClojure provides a
`domain.math.core` namespace that abstracts the underlying complex
linear algebra implementation. This namespace provides the public API
for complex linear algebra operations used in QClojure. It allows to
switch between different implementations of complex linear algebra
without changing the QClojure code.

Protocols define the operations that need to be implemented by a
specific complex linear algebra backend implementation:

- MatrixAlgebra - defining basic matrix operations like addition,
  multiplication, products (kronecker/tensor, outer, inner, hadamard),
  conjugate transpose, etc.
- MatrixDecompositions - defining matrix decompositions like singular
  value decomposition, eigenvalue decomposition, etc.
- MatrixFunctions - defining matrix functions like exponentiation,
  logarithm, square root, etc.
- MatrixAnalysis - defining matrix analysis functions like spectral
  norm, condition number, etc.

Currently, QClojure supports two backend implementations:

- Fastmath Backend (`:fastmath`), based on FastMath, a high-performance
  numerical computing library for Clojure. It provides efficient
  implementations of complex linear algebra operations based on Apache
  Commons Math.
- Pure Clojure Math Backend (`:pure`), based on Clojure Math, a pure
  Clojure implementation of complex linear algebra operations for
  educational purpose only.

The Fastmath backend is the default backend used by QClojure, as it
provides better performance for large quantum states and circuits. The
Clojure Math backend should be used only for educational purposes or for
small quantum states and circuits.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.domain.math.complex-linear-algebra :as cla])
```

</div>

You can switch between the backends by using the `set-backend` function.
After switching the backend, all complex linear algebra operations will
use the selected backend. Backends may use a different representation
for complex numbers and matrices, but the public API handles the
conversion between the different representations.

The backend can be switched at any time, but it is recommended to set
the backend at the beginning of the program, before any quantum states
or circuits are created.

To switch to the pure Clojure Math backend, use the following code:

<div class="sourceClojure">

``` clojure
(cla/set-backend! :pure)
```

</div>

<div class="printedClojure">

``` clojure
:pure
```

</div>

Now, all complex linear algebra operations will use the pure Clojure
Math backend.

You can switch back to the Fastmath backend by using the following code:

<div class="sourceClojure">

``` clojure
(cla/set-backend! :fastmath)
```

</div>

<div class="printedClojure">

``` clojure
:fastmath
```

</div>

A BLAS/LAPACK (CPU) and OpenCL/CUDA (GPU) enabled backend would be
desirable for simulating larger quantum states and circuits, but is not
yet available.

## Quantum Computing Backends

QClojure can be extended with backends to run quantum circuits on real
quantum hardware. The *application.backend* namespace contains the
protocols to be implemented by a specific backend. A backend can be used
to execute a quantum circuit.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.backend :as qb])
```

</div>

QClojure comes with two simulator backends in the *adapter.backend* that
can be used to simulate quantum circuits on a classical computer.

- The ideal simulator backend simulates an ideal quantum computer
  without physical constraints like noise.
- The hardware simulator backend simulates a real quantum computer with
  a native gate set, a topology of coupled qubits and various kinds of
  noise.

Additional backends to access quantum hardware will be available as
separate libraries. There is already an experimental implementation for
an Amazon Braket backend available in the
[qclojure-braket](https://github.com/lsolbach/qclojure-braket) project.

Simulating quantum circuits on a classical computer is computationally
expensive, as the state space of a quantum system grows exponentially
with the number of qubits. Therefore, the simulator backends are limited
to a certain number of qubits, depending on the available memory and
processing power of the classical computer. The simulator backends are
limited to about 20 qubits on a typical desktop computer. Also note that
the time to simulate a quantum circuit grows exponentially with the
number of qubits and the depth of the circuit. Therefore, simulating
quantum circuits with a large number of qubits or a deep circuit can
take a long time.

### Ideal Simulator Backend

Let’s try the ideal simulator first by requiring the `ideal-simulator`
namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.backend.ideal-simulator :as sim])
```

</div>

We create the simulator backend with the `create-simulator` function.

<div class="sourceClojure">

``` clojure
(def simulator (sim/create-simulator))
```

</div>

Now we can use the simulator to execute the ghz circuit on the
simulator.

<div class="sourceClojure">

``` clojure
(qb/execute-circuit simulator (circuit/ghz-state-circuit 3))
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :results
 {:final-state
  {:state-vector
   [[0.7071067811865475 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.7071067811865475 0.0]],
   :num-qubits 3},
  :result-types #{},
  :circuit-metadata
  {:circuit-depth 3,
   :circuit-operation-count 3,
   :circuit-gate-count 3,
   :num-qubits 3}},
 :execution-time-ms 1,
 :job-id "sim_job_5923_1757177336799"}
```

</div>

When executing a circuit on a backend, it will be executed multiple
times, because of the probabilistic nature of quantum computing. One
execution of the circuit is called a *shot*. The default number of shots
is 512, but it can be configured via an options map.

<div class="sourceClojure">

``` clojure
(qb/execute-circuit simulator (circuit/ghz-state-circuit 3) {:shots 10})
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :results
 {:final-state
  {:state-vector
   [[0.7071067811865475 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.0 0.0]
    [0.7071067811865475 0.0]],
   :num-qubits 3},
  :result-types #{},
  :circuit-metadata
  {:circuit-depth 3,
   :circuit-operation-count 3,
   :circuit-gate-count 3,
   :num-qubits 3}},
 :execution-time-ms 1,
 :job-id "sim_job_5924_1757177336912"}
```

</div>

### Hardware Simulator Backend

Currently existing real quantum hardware has a set of limitations
compared to what our ideal simulator supports:

- supports only a limited set of native quantum gates
- may have a limited topology of coupled qubits
- is subject to various kinds of noise

This has some consequences for running quantum circuits on real quantum
hardware, also known as Quantum Processing Units (QPUs). The limited
native gate set means that our circuit has to be transformed to only use
those native gates. This is done by decomposing unsupported gates to
supported gates. The limited topology means that not all qubits can be
used freely in a multi-qubit gate, e.g. a CNOT gate. If a CNOT gate
should be applied to qubits which are not coupled in the topology,
represente by a coupling map, Swap gates have to be introduced to ‘move’
the information to qubits that are coupled, so that the CNOT gate can be
applied. The various kinds of noise affect the results of quantum
computations. They can be addressed by error correction, which uses a
number of physical qubits to form a logical qubit. On current QPUs with
limited qubit counts this is not always an option. Error mitigation
strategies try to address the problem mathematically or with more
executions.

The hardware simulator backend simulates a quantum computer with noise,
allowing us to study the effects of noise on quantum circuits.

The hardware simulator backend simulates these kinds of noise:

- depolarizing noise is a type of noise that randomly flips the state of
  a qubit with a certain probability.
- amplitude damping noise is a type of noise that causes the state of a
  qubit to decay over time with a certain probability.
- bit flip noise is a type of noise that flips the state of a qubit from
  \|0⟩ to \|1⟩ or from \|1⟩ to \|0⟩ with a certain probability.
- phase flip noise is a type of noise that flips the phase of the state
  of a qubit from \|0⟩ to \|1⟩ or from \|1⟩ to \|0⟩ with a certain
  probability.
- readout noise is a type of noise that affects the measurement of the
  state of a qubit, causing the measured value to be incorrect with a
  certain probability.

The hardware simulator backend applies the noise to the quantum states
and gates in the circuit, simulating the effects of noise on the quantum
computation.

Let’s try the hardware simulator first by requiring the
`hardware-similator` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.adapter.backend.hardware-simulator :as noisy])
```

</div>

We can instantiate the hardware simulator with the
`create-noisy-simulator` function and provide a provide a device map.
The device map we use here is derived from the IBM Lagos Quantum
Computer.

<div class="sourceClojure">

``` clojure
(qb/devices :ibm-lagos)
```

</div>

<div class="printedClojure">

``` clojure
{:name "IBM Lagos",
 :provider "IBM",
 :description
 "IBM Lagos characteristics:\n* 7 qubits\n* Heavy-hex topology\n* Advanced error suppression techniques\n* High connectivity and low crosstalk",
 :architecture
 {:max-qubits 7,
  :native-gates #{:y :rx :cz :z :h :x :rz :ry :cnot},
  :topology :heavy-hex},
 :noise-model
 {:gate-noise
  {:h
   {:noise-type :depolarizing,
    :noise-strength 5.0E-4,
    :t1-time 125.0,
    :t2-time 89.0,
    :gate-time 35.6},
   :x
   {:noise-type :depolarizing,
    :noise-strength 3.0E-4,
    :t1-time 125.0,
    :t2-time 89.0,
    :gate-time 35.6},
   :cnot
   {:noise-type :depolarizing,
    :noise-strength 0.006,
    :t1-time 125.0,
    :t2-time 89.0,
    :gate-time 476.0}},
  :readout-error {:prob-0-to-1 0.013, :prob-1-to-0 0.028}}}
```

</div>

The noise profile shows configurations for the different types of noise,
a physical quantum computer can have. All different types of noise
contribute to the errors in the measurement.

Let’s instantiate the noisy simulator with the IBM Lagos profile.

<div class="sourceClojure">

``` clojure
(def lagos-simulator (noisy/create-hardware-simulator (qb/devices :ibm-lagos)))
```

</div>

Now we can use the simulator to execute the ghz circuit on the
simulator. Because we use a noisy simulator, we may measure wrong
answers.

<div class="sourceClojure">

``` clojure
(def lagos-50-result (qb/execute-circuit lagos-simulator (circuit/ghz-state-circuit 3) {:shots 50}))
```

</div>

<div class="sourceClojure">

``` clojure
lagos-50-result
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :measurement-results {"000" 25, "111" 23, "011" 1, "101" 1},
 :final-state
 {:num-qubits 3,
  :state-vector
  [[0.7071067811865476 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.7071067811865476 0.0]]},
 :noise-applied true,
 :shots-executed 50,
 :execution-time-ms 52,
 :job-id "noisy_job_28_1757177337029"}
```

</div>

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (:final-state lagos-50-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (3 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.0" y2="252.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.0" y2="204.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.0">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.00000000000003" y2="156.00000000000003"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.00000000000003">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.00000000000003" y2="108.00000000000003"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.00000000000003">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.00000000000006" y2="60.00000000000006"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.00000000000006">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|000⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|111⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|111⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

We see, that not all measurements measure the states \|000⟩ and \|111⟩,
even though those states should have the highest counts. The other
states should have a distinctively lower count. But if you use to few
shots, you could be unlucky and measure the wrong answers. The
probability to measure the wrong answers gets lower by increasing the
number of shots.

<div class="sourceClojure">

``` clojure
(def lagos-10k-result (qb/execute-circuit lagos-simulator (circuit/ghz-state-circuit 3) {:shots 10000}))
```

</div>

<div class="sourceClojure">

``` clojure
lagos-10k-result
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :measurement-results
 {"000" 4794,
  "111" 4527,
  "110" 181,
  "100" 69,
  "101" 146,
  "001" 84,
  "011" 114,
  "010" 85},
 :final-state
 {:num-qubits 3,
  :state-vector
  [[0.7071067811865476 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.7071067811865476 0.0]]},
 :noise-applied true,
 :shots-executed 10000,
 :execution-time-ms 5286,
 :job-id "noisy_job_29_1757177337142"}
```

</div>

With 10000 shots, the difference of the counts of the correct answers
and the counts of the wrong answers should be quite significant.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-measurement-histogram :svg (:measurement-results lagos-10k-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                     rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Measurement Results (10000 shots)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Measurement Counts</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300" y2="300"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303">0</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.04005" y2="252.04005"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.04005">958</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.0801" y2="204.0801"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.0801">1916</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.12015" y2="156.12015"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.12015">2874</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.1602" y2="108.1602"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.1602">3832</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.20025" y2="60.20025"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.20025">4790</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="80" y="60"><title>|000⟩: 4794 shots (47.9%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="110" y="320">|000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="110" y="55">4794 shots</text></g><g class="bar-group"><rect fill="#3b82f6" height="226.63329" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="140" y="73.36671"><title>|111⟩: 4527 shots (45.3%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="170" y="320">|111⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="170" y="68.36671">4527 shots</text></g><g class="bar-group"><rect fill="#10b981" height="9.061327" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="200" y="290.93866"><title>|110⟩: 181 shots (1.8%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="230" y="320">|110⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="230" y="285.93866">181 shots</text></g><g class="bar-group"><rect fill="#f59e0b" height="7.3091364" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="260" y="292.69086"><title>|101⟩: 146 shots (1.5%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="290" y="320">|101⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="290" y="287.69086">146 shots</text></g><g class="bar-group"><rect fill="#ef4444" height="5.707134" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="320" y="294.29288"><title>|011⟩: 114 shots (1.1%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="350" y="320">|011⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="350" y="289.29288">114 shots</text></g><g class="bar-group"><rect fill="#8b5cf6" height="4.255319" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="380" y="295.7447"><title>|010⟩: 85 shots (0.9%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="410" y="320">|010⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="410" y="290.7447">85 shots</text></g><g class="bar-group"><rect fill="#06b6d4" height="4.2052565" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="440" y="295.79474"><title>|001⟩: 84 shots (0.8%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="470" y="320">|001⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="470" y="290.79474">84 shots</text></g><g class="bar-group"><rect fill="#84cc16" height="3.4543178" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="500" y="296.5457"><title>|100⟩: 69 shots (0.7%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="530" y="320">|100⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="530" y="291.5457">69 shots</text></g></svg>

We can also use the hardware simulator with a different device map, e.g.
for an IonQ Forte quantum computer.

<div class="sourceClojure">

``` clojure
(qb/devices :ionq-forte)
```

</div>

<div class="printedClojure">

``` clojure
{:name "IonQ Forte",
 :provider "IonQ",
 :description
 "IonQ Forte characteristics:\n* 32 qubits (#AQ 29)\n* Latest generation with highest fidelity\n* Enhanced error correction capabilities\n* Fastest gate times in IonQ family",
 :architecture
 {:max-qubits 32,
  :native-gates #{:y :rx :z :h :x :ms :rz :ry :cnot},
  :topology :all-to-all},
 :noise-model
 {:gate-noise
  {:h
   {:noise-type :coherent,
    :coherent-error {:rotation-angle 3.0E-4, :rotation-axis :y},
    :t1-time 20000.0,
    :t2-time 10000.0,
    :gate-time 30000.0},
   :x
   {:noise-type :coherent,
    :coherent-error {:rotation-angle 2.0E-4, :rotation-axis :x},
    :t1-time 20000.0,
    :t2-time 10000.0,
    :gate-time 30000.0},
   :y
   {:noise-type :coherent,
    :coherent-error {:rotation-angle 2.0E-4, :rotation-axis :y},
    :t1-time 20000.0,
    :t2-time 10000.0,
    :gate-time 30000.0},
   :z
   {:noise-type :phase-damping,
    :noise-strength 3.0E-5,
    :t1-time 20000.0,
    :t2-time 10000.0,
    :gate-time 30.0},
   :cnot
   {:noise-type :depolarizing,
    :noise-strength 0.003,
    :t1-time 20000.0,
    :t2-time 10000.0,
    :gate-time 120000.0}},
  :readout-error {:prob-0-to-1 0.001, :prob-1-to-0 0.002}}}
```

</div>

Let’s instantiate the noisy simulator with the IonQ Forte profile.

<div class="sourceClojure">

``` clojure
(def forte-simulator (noisy/create-hardware-simulator (qb/devices :ionq-forte)))
```

</div>

We now execute the GHZ circuit on this simulator with 10000 shots and
compare the results with the IBM Lagos simulation.

<div class="sourceClojure">

``` clojure
(def forte-10k-result (qb/execute-circuit forte-simulator (circuit/ghz-state-circuit 3) {:shots 10000}))
```

</div>

<div class="sourceClojure">

``` clojure
forte-10k-result
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :measurement-results
 {"111" 4834,
  "000" 5078,
  "101" 24,
  "110" 20,
  "100" 5,
  "010" 18,
  "001" 12,
  "011" 9},
 :final-state
 {:num-qubits 3,
  :state-vector
  [[0.7072128392483766 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.0 0.0]
   [0.7070007072148161 0.0]]},
 :noise-applied true,
 :shots-executed 10000,
 :execution-time-ms 3071,
 :job-id "noisy_job_30_1757177342467"}
```

</div>

Compared to the IBM Lagos simulation, the IonQ Forte simulation should
have distinctly lower noise and thus a higher count for the correct
answers.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-measurement-histogram :svg (:measurement-results forte-10k-result)))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                     rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Measurement Results (10000 shots)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Measurement Counts</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300" y2="300"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303">0</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="252.02835" y2="252.02835"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="255.02835">1015</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="204.05672" y2="204.05672"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="207.05672">2030</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="156.08507" y2="156.08507"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="159.08507">3045</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="108.113434" y2="108.113434"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="111.113434">4060</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.14179" y2="60.14179"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.14179">5075</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="80" y="60"><title>|000⟩: 5078 shots (50.8%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="110" y="320">|000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="110" y="55">5078 shots</text></g><g class="bar-group"><rect fill="#3b82f6" height="228.4679" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="140" y="71.5321"><title>|111⟩: 4834 shots (48.3%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="170" y="320">|111⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="170" y="66.5321">4834 shots</text></g><g class="bar-group"><rect fill="#10b981" height="1.1343049" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="200" y="298.8657"><title>|101⟩: 24 shots (0.2%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="230" y="320">|101⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="230" y="293.8657">24 shots</text></g><g class="bar-group"><rect fill="#f59e0b" height="0.945254" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="260" y="299.05475"><title>|110⟩: 20 shots (0.2%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="290" y="320">|110⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="290" y="294.05475">20 shots</text></g><g class="bar-group"><rect fill="#ef4444" height="0.85072863" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="320" y="299.14926"><title>|010⟩: 18 shots (0.2%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="350" y="320">|010⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="350" y="294.14926">18 shots</text></g><g class="bar-group"><rect fill="#8b5cf6" height="0.56715244" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="380" y="299.43286"><title>|001⟩: 12 shots (0.1%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="410" y="320">|001⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="410" y="294.43286">12 shots</text></g><g class="bar-group"><rect fill="#06b6d4" height="0.42536432" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="440" y="299.57465"><title>|011⟩: 9 shots (0.1%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="470" y="320">|011⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="470" y="294.57465">9 shots</text></g><g class="bar-group"><rect fill="#84cc16" height="0.2363135" opacity="0.8" stroke="#ffffff" stroke-width="1" width="58" x="500" y="299.76367"><title>|100⟩: 5 shots (0.1%)</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="530" y="320">|100⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="530" y="294.76367">5 shots</text></g></svg>

You can also create your own device profiles by defining a device map
with the required parameters. You can then use this device map to create
a hardware simulator backend. A device map may not have all parameters
defined. In this case some features may not be used, e.g. error
mitigation techniques. If you provide a device map with no native-gates,
coupling and noise model defined, the hardware simulator will behave
like the ideal simulator. You can also modify an existing device map to
create a new device map for testing specific aspects or scenarios.

## Circuit Optimization and Transformation

Quantum circuits can be optimized and transformed to improve their
performance and to run on specific quantum hardware. QClojure provides a
set of optimization and transformation techniques that can be applied to
quantum circuits.

### Gate Optimization

Gate optimization is a technique used to reduce the number of gates in a
quantum circuit. It is based on the idea that some gates can be combined
or eliminated without changing the overall functionality of the circuit.
Gate optimization can be applied to quantum circuits to improve their
performance and to reduce the effects of noise. For example, consecutive
Pauli and Hadamard gates can be eliminated, as they are self-inverse.

### Qubit Optimization

Qubit optimization is a technique used to reduce the number of qubits in
a quantum circuit. It is based on the idea that some qubits can be
eliminated without changing the overall functionality of the circuit.
The simplest case is to eliminate qubits that are not used in the
circuit.

### Topology Optimization

Topology optimization is a technique used to transform a quantum circuit
to run on specific quantum hardware. Quantum hardware has a limited
topology of coupled qubits, which means that not all qubits can be used
freely in a multi-qubit gate, e.g. a CNOT gate. If a CNOT gate should be
applied to qubits which are not coupled in the topology, represented by
a coupling map, Swap gates have to be introduced to ‘move’ the
information to qubits that are coupled, so that the CNOT gate can be
applied. Topology optimization can be applied to quantum circuits to
transform them to run on specific quantum hardware.

### Gate Decomposition

Gate decomposition is a technique used to transform a quantum circuit to
use only a limited set of native quantum gates. Quantum hardware
supports only a limited set of native quantum gates, which means that
some gates in a quantum circuit may not be supported by the hardware.
Gate decomposition can be applied to quantum circuits to transform them
to use only the native gates supported by the hardware. For example, a
Toffoli gate can be decomposed into a series of CNOT and single-qubit
gates.

### The Optimization Pipeline

QClojure provides an optimization pipeline that can be used to apply
these optimization and transformation techniques to a quantum circuit.
The optimization pipeline will apply the techniques in a specific order
to optimize and transform the quantum circuit for a specific hardware.

The optimization pipeline is used in the hardware simulator backend to
optimize and transform the quantum circuit before executing it on the
simulator.

## Error Mitigation

Error mitigation is a collection of techniques used to reduce the
effects of noise in quantum computations. It is not a full error
correction, but it can improve the results of quantum computations by
reducing the errors caused by noise. Error mitigation techniques can be
applied to quantum circuits to improve the results of quantum
computations.

QClojure provides a set of error mitigation techniques that can be used
to reduce the effects of noise in quantum computations.

### Readout Error Mitigation

Readout error mitigation is a technique used to reduce the effects of
readout noise in quantum computations. It is based on the idea that the
readout noise can be modeled as a matrix that describes the probability
of measuring a certain state given the true state of the qubit.

### Zero Noise Extrapolation

Zero noise extrapolation is a technique used to reduce the effects of
noise in quantum computations by extrapolating the results of the
computation to zero noise. It is based on the idea that the results of
the computation can be extrapolated to zero noise by measuring the
results of the computation with different noise levels and fitting a
curve to the results.

### Symmetry Verification

Symmetry verification is a technique used to reduce the effects of noise
in quantum computations by verifying the symmetry of the quantum
circuit. It is based on the idea that the results of the computation can
be verified by checking the symmetry of the quantum circuit. If the
circuit is symmetric, the results of the computation should be the same
for all qubits.

### Virtual Distillation

Virtual distillation is a technique that improves computation fidelity
by running multiple copies of quantum circuits and applying
sophisticated post-processing to extract high-fidelity results through
probabilistic error cancellation.

## Algorithms

QClojure comes with a set of predefined quantum algorithms that can be
used to solve specific problems. These algorithms are implemented as
quantum circuits and can be executed on quantum hardware or simulated
using the simulator backends.

### Deutsch Algorithm

The [Deutsch algorithm](https://en.wikipedia.org/wiki/Deutsch_algorithm)
is a simple quantum algorithm that determines whether a function is
constant or balanced. It uses a quantum circuit to evaluate the function
with only one query, compared to two queries needed for classical
algorithms. The quantum circuit uses an oracle to implement the function
and applies a Hadamard gate to the input qubit.

#### Problem Statement

Given a function f: {0, 1} → {0, 1}, the goal is to determine if f is
constant (returns the same value for both inputs) or balanced (returns 0
for one input and 1 for the other).

#### Classical Approach

In a classical setting, we would need to evaluate the function f twice:

- If f(0) = f(1), then f is constant.
- If f(0) != f(1), then f is balanced.

#### Quantum Approach

The Deutsch algorithm allows us to determine the nature of the function
with only one evaluation by leveraging quantum superposition and
interference.

#### Quantum Circuit

The Deutsch algorithm can be implemented using a quantum circuit with
the following steps:

1.  Initialize a qubit in the state \|0⟩ and an auxiliary qubit in the
    state \|1⟩.
2.  Apply a Hadamard gate to both qubits to create superposition.
3.  Apply the function f as a quantum gate, which will entangle the
    qubits.
4.  Apply another Hadamard gate to the first qubit.
5.  Measure the first qubit.

To examine the Deutsch algorithm, we need to require the `deutsch`
namespace from the `application.algorithm` package.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.deutsch :as deutsch])
```

</div>

Let’s define a constant function and a balanced function first.

Constant function: f(x) = 1

<div class="sourceClojure">

``` clojure
(def constant-fn (fn [_x] true))
```

</div>

Balanced function: f(x) = x

<div class="sourceClojure">

``` clojure
(def balanced-fn (fn [x] x))
```

</div>

Now we can create the circuit for the Deutsch algorithm for the constant
function.

<div class="sourceClojure">

``` clojure
(def constant-deutsch-circuit
  (deutsch/deutsch-circuit constant-fn))
```

</div>

We can visualize the circuit for the constant oracle.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg constant-deutsch-circuit))
```

</div>

<svg height="220" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="420" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="210" y="35">Deutsch Algorithm</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="370" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="370" y1="130" y2="130"></line></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="235" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="250" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="75">H</text><title>:h gate on qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="375" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="390" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="375" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="390" y="135">M</text><title>Measure qubit 1</title></g><g><text fill="#6b7280" font-size="12" x="30" y="190">Qubits: 2 | Gates: 5 | Depth: 3</text><text fill="#6b7280" font-size="12" x="30" y="205">Determines if function is constant or balanced</text></g></svg>

The circuit shows that the Hadamard gate is applied to the input qubit,
followed by the oracle function Uf. The oracle function Uf is
implemented as a series of quantum gates that applies the constant
function. Now we can execute the Deutsch algorithm with the constant
function. We use the simulator backend to execute the circuit.

<div class="sourceClojure">

``` clojure
(def deutsch-constant-result
  (deutsch/deutsch-algorithm (sim/create-simulator) constant-fn {:shots 1}))
```

</div>

The result of the Deutsch algorithm is a map that contains the result of
the algorithm, the measurement outcome, and the circuit used to execute
the algorithm.

<div class="sourceClojure">

``` clojure
deutsch-constant-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Deutsch",
 :result :constant,
 :probability-zero 0.9999999999999996,
 :circuit
 {:operations
  [{:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 0}}],
  :num-qubits 2,
  :name "Deutsch Algorithm",
  :description "Determines if function is constant or balanced"},
 :execution-result
 {:job-status :completed,
  :results
  {:final-state
   {:state-vector
    [[-0.7071067811865474 0.0]
     [0.7071067811865474 0.0]
     [0.0 0.0]
     [0.0 0.0]],
    :num-qubits 2},
   :result-types #{:measurements :probabilities},
   :circuit-metadata
   {:circuit-depth 3,
    :circuit-operation-count 5,
    :circuit-gate-count 5,
    :num-qubits 2},
   :measurement-results
   {:measurement-outcomes [0],
    :measurement-probabilities
    [0.4999999999999998 0.4999999999999998 0.0 0.0],
    :empirical-probabilities {0 1},
    :shot-count 1,
    :measurement-qubits (0 1),
    :frequencies {0 1}},
   :probability-results
   {:probability-outcomes
    {0 0.4999999999999998, 1 0.4999999999999998, 2 0.0, 3 0.0},
    :target-qubits [0],
    :all-probabilities
    [0.4999999999999998 0.4999999999999998 0.0 0.0]}},
  :execution-time-ms 0,
  :job-id "sim_job_5925_1757177345582"}}
```

</div>

The result shows that the Deutsch algorithm correctly identifies the
constant function. The measurement outcome is 0, which indicates that
the function is constant.

<div class="sourceClojure">

``` clojure
(:result deutsch-constant-result)
```

</div>

<div class="printedClojure">

``` clojure
:constant
```

</div>

Let’s visualize the final quantum state after executing the Deutsch
algorithm with the constant function. It is contained in the execution
result of the algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (get-in deutsch-constant-result [:execution-result :results :final-state])))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (2 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="251.99999999999997" y2="251.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="254.99999999999997">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999994" y2="203.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999994">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999994" y2="155.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999994">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999989" y2="107.99999999999989"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999989">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.999999999999886" y2="59.999999999999886"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.999999999999886">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|00⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|00⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|01⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|01⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

For the balanced function, we can create the circuit for the Deutsch
algorithm.

<div class="sourceClojure">

``` clojure
(def balanced-deutsch-circuit
  (deutsch/deutsch-circuit balanced-fn))
```

</div>

We can visualize the circuit for the balanced oracle.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg balanced-deutsch-circuit))
```

</div>

<svg height="220" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="480" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="240" y="35">Deutsch Algorithm</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="430" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="430" y1="130" y2="130"></line></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="75">H</text><title>:h gate on qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="435" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="450" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="435" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="450" y="135">M</text><title>Measure qubit 1</title></g><g><text fill="#6b7280" font-size="12" x="30" y="190">Qubits: 2 | Gates: 5 | Depth: 4</text><text fill="#6b7280" font-size="12" x="30" y="205">Determines if function is constant or balanced</text></g></svg>

Execute the Deutsch algorithm with the balanced function.

<div class="sourceClojure">

``` clojure
(def deutsch-balanced-result
  (deutsch/deutsch-algorithm (sim/create-simulator) balanced-fn {:shots 1}))
```

</div>

The result of the Deutsch algorithm is a map that contains the result of
the algorithm, the measurement outcome, and the circuit used to execute
the algorithm.

<div class="sourceClojure">

``` clojure
deutsch-balanced-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Deutsch",
 :result :balanced,
 :probability-zero 0.0,
 :circuit
 {:operations
  [{:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :h, :operation-params {:target 0}}],
  :num-qubits 2,
  :name "Deutsch Algorithm",
  :description "Determines if function is constant or balanced"},
 :execution-result
 {:job-status :completed,
  :results
  {:final-state
   {:state-vector
    [[0.0 0.0]
     [0.0 0.0]
     [0.7071067811865474 0.0]
     [-0.7071067811865474 0.0]],
    :num-qubits 2},
   :result-types #{:measurements :probabilities},
   :circuit-metadata
   {:circuit-depth 4,
    :circuit-operation-count 5,
    :circuit-gate-count 5,
    :num-qubits 2},
   :measurement-results
   {:measurement-outcomes [3],
    :measurement-probabilities
    [0.0 0.0 0.4999999999999998 0.4999999999999998],
    :empirical-probabilities {3 1},
    :shot-count 1,
    :measurement-qubits (0 1),
    :frequencies {3 1}},
   :probability-results
   {:probability-outcomes
    {0 0.0, 1 0.0, 2 0.4999999999999998, 3 0.4999999999999998},
    :target-qubits [0],
    :all-probabilities
    [0.0 0.0 0.4999999999999998 0.4999999999999998]}},
  :execution-time-ms 2,
  :job-id "sim_job_5926_1757177345703"}}
```

</div>

The result shows that the Deutsch algorithm correctly identifies the
balanced function.

<div class="sourceClojure">

``` clojure
(:result deutsch-balanced-result)
```

</div>

<div class="printedClojure">

``` clojure
:balanced
```

</div>

Let’s visualize the final quantum state after executing the Deutsch
algorithm with the balanced function.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (get-in deutsch-balanced-result [:execution-result :results :final-state])))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (2 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="300"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="300.0" y2="300.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="303.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="251.99999999999997" y2="251.99999999999997"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="254.99999999999997">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="203.99999999999994" y2="203.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="206.99999999999994">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="155.99999999999994" y2="155.99999999999994"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="158.99999999999994">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="107.99999999999989" y2="107.99999999999989"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="110.99999999999989">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="59.999999999999886" y2="59.999999999999886"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="62.999999999999886">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="300" y2="300"></line><g class="bar-group"><rect fill="#7c3aed" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|10⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="200" y="320">|10⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="240.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|11⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="middle" x="440" y="320">|11⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

### Bernstein-Vazirani Algorithm

The [Bernstein-Vazirani
algorithm](https://en.wikipedia.org/wiki/Bernstein%E2%80%93Vazirani_algorithm)
is a powerful quantum algorithm that can be used to solve problems that
are difficult for classical computers. It is a quantum algorithm that
determines a hidden binary string using a quantum circuit to evaluate
the function with only one query, compared to n queries needed for
classical algorithms.

The quantum circuit uses an oracle to implement the function and applies
a Hadamard gate to the input qubit.

#### Problem Statement

Given a function f: {0, 1}ⁿ → {0, 1} defined as f(x) = s ⨯ x (where s is
a hidden string and ⨯ denotes the dot product), the goal is to find the
hidden string s using as few evaluations of f as possible.

#### Classical Approach

In a classical setting, we would need to evaluate the function f
multiple times to determine the hidden string s. The number of
evaluations required can grow linearly with the size of the input.

#### Quantum Approach

The Bernstein-Vazirani algorithm allows us to find the hidden string s
with only one evaluation by leveraging quantum superposition and
interference.

#### Quantum Circuit

The Bernstein-Vazirani algorithm can be implemented using a quantum
circuit with the following steps:

1.  Initialize n qubits in the state \|0⟩ and an auxiliary qubit in the
    state \|1⟩.
2.  Apply a Hadamard gate to all n qubits to create superposition.
3.  Apply the function f as a quantum gate, which will entangle the
    qubits.
4.  Apply another Hadamard gate to all n qubits.
5.  Measure the qubits to obtain the hidden string s.

To examine the Bernstein-Vazirani algorithm, we need to require the
`bernstein-vazirani` namespace from the `application.algorithm` package.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.bernstein-vazirani :as bv])
```

</div>

Let’s define a hidden binary string first.

<div class="sourceClojure">

``` clojure
(def hidden-string [1 1 0])
```

</div>

Hidden binary string: 110

Now we can create the circuit for the Bernstein-Vazirani algorithm.

<div class="sourceClojure">

``` clojure
(def bv-circuit
  (bv/bernstein-vazirani-circuit hidden-string))
```

</div>

We can visualize the circuit for the Bernstein-Vazirani algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg bv-circuit))
```

</div>

<svg height="340" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="300" y="35">Bernstein-Vazirani Algorithm</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="190" y2="190"></line></g><g><text fill="#374151" font-size="14" x="30" y="255">q3 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="250" y2="250"></line></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="238"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="255">X</text><title>:x gate on qubit 3</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="238"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="255">H</text><title>:h gate on qubit 3</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="250" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="250" y2="250"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="242" y2="258"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="250"></line><title>CNOT: control=0, target=3</title></g><g class="gate-group"><circle cx="310" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="310" cy="250" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="302" x2="318" y1="250" y2="250"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="242" y2="258"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="130" y2="250"></line><title>CNOT: control=1, target=3</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="195">H</text><title>:h gate on qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="195">M</text><title>Measure qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="238"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="255">M</text><title>Measure qubit 3</title></g><g><text fill="#6b7280" font-size="12" x="30" y="310">Qubits: 4 | Gates: 10 | Depth: 6</text><text fill="#6b7280" font-size="12" x="30" y="325">Finds hidden bit string s with one query</text></g></svg>

The circuit shows that the Hadamard gate is applied to the input qubits,
followed by the oracle function Uf. The oracle function Uf is
implemented as a series of quantum gates that applies the hidden binary
string. Now we can execute the Bernstein-Vazirani algorithm with the
hidden binary string.

<div class="sourceClojure">

``` clojure
(def bv-result
  (bv/bernstein-vazirani-algorithm (sim/create-simulator) hidden-string {:shots 1}))
```

</div>

The result of the Bernstein-Vazirani algorithm is a map that contains
the result of the algorithm, the measurement outcome, and the circuit
used to execute the algorithm.

<div class="sourceClojure">

``` clojure
bv-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Bernstein-Vazirani",
 :result [1 1 0],
 :success true,
 :hidden-string [1 1 0],
 :circuit
 {:operations
  [{:operation-type :x, :operation-params {:target 3}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :h, :operation-params {:target 3}}
   {:operation-type :cnot, :operation-params {:control 0, :target 3}}
   {:operation-type :cnot, :operation-params {:control 1, :target 3}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [0]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [1]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [2]}}],
  :num-qubits 4,
  :name "Bernstein-Vazirani Algorithm",
  :description "Finds hidden bit string s with one query"},
 :execution-result
 {:job-status :completed,
  :results
  {:final-state
   {:state-vector
    [[0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.0 0.0]
     [0.7071067811865476 0.0]
     [-0.7071067811865476 0.0]
     [0.0 0.0]
     [0.0 0.0]],
    :num-qubits 4},
   :result-types #{:measurements :probabilities},
   :circuit-metadata
   {:circuit-depth 6,
    :circuit-operation-count 13,
    :circuit-gate-count 10,
    :num-qubits 4},
   :measurement-results
   {:measurement-outcomes [12],
    :measurement-probabilities
    [0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.5000000000000001
     0.5000000000000001
     0.0
     0.0],
    :empirical-probabilities {12 1},
    :shot-count 1,
    :measurement-qubits (0 1 2 3),
    :frequencies {12 1}},
   :probability-results
   {:probability-outcomes
    {0 0.0,
     7 0.0,
     1 0.0,
     4 0.0,
     15 0.0,
     13 0.5000000000000001,
     6 0.0,
     3 0.0,
     12 0.5000000000000001,
     2 0.0,
     11 0.0,
     9 0.0,
     5 0.0,
     14 0.0,
     10 0.0,
     8 0.0},
    :target-qubits (0 1 2),
    :all-probabilities
    [0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.5000000000000001
     0.5000000000000001
     0.0
     0.0]}},
  :execution-time-ms 18,
  :job-id "sim_job_5927_1757177345831"}}
```

</div>

The result shows that the Bernstein-Vazirani algorithm correctly
identifies the hidden binary string.

<div class="sourceClojure">

``` clojure
(:result bv-result)
```

</div>

<div class="printedClojure">

``` clojure
[1 1 0]
```

</div>

The measurement outcome is the hidden binary string, which is 110. Let’s
visualize the final quantum state after executing the Bernstein-Vazirani
algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (get-in bv-result [:execution-result :results :final-state])))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (4 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="280"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="280.0" y2="280.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="283.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="236.0" y2="236.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="239.0">10%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="192.0" y2="192.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="195.0">20%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="148.00000000000003" y2="148.00000000000003"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="151.00000000000003">30%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="104.00000000000003" y2="104.00000000000003"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="107.00000000000003">40%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="60.00000000000006" y2="60.00000000000006"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="63.00000000000006">50%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="280" y2="280"></line><g class="bar-group"><rect fill="#7c3aed" height="220.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="80" y="60.0"><title>|1100⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 200 300)" x="200" y="300">|1100⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="200" y="55.0">50.0%</text></g><g class="bar-group"><rect fill="#3b82f6" height="220.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="238" x="320" y="60.0"><title>|1101⟩: 50.0%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 440 300)" x="440" y="300">|1101⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="440" y="55.0">50.0%</text></g></svg>

The final quantum state shows that the Bernstein-Vazirani algorithm
correctly identifies the hidden binary string. The final quantum state
is a superposition of the states that represent the hidden binary
string.

### Simon’s Algorithm

[Simon’s algorithm](https://en.wikipedia.org/wiki/Simon's_algorithm)
solves the hidden subgroup problem for the group (Z₂)ⁿ. Given a function
f: {0,1}ⁿ → {0,1}ⁿ that is either one-to-one or two-to-one, and if
two-to-one then f(x) = f(x ⊕ s) for some hidden string s ≠ 0ⁿ, the
algorithm finds s with exponential speedup over classical methods.

The quantum circuit uses an oracle to implement the function and applies
a Hadamard gate to the input qubits.

#### Problem Statement

Given a function f: {0,1}ⁿ → {0,1}ⁿ that is promised to be periodic with
a hidden period s, the goal is to find s using fewer evaluations of f
than would be possible classically.

#### Classical Approach

In a classical setting, we would need to evaluate the function f
multiple times to find the period s. The number of evaluations required
can grow exponentially with the size of the input.

#### Quantum Approach

The Simon algorithm allows us to find the hidden period s with a
polynomial number of evaluations by leveraging quantum superposition and
interference.

#### Quantum Circuit

The Simon algorithm can be implemented using a quantum circuit with the
following steps:

1.  Initialize n qubits in the state \|0⟩ and n auxiliary qubits in the
    state \|1⟩.
2.  Apply a Hadamard gate to all n qubits to create superposition.
3.  Apply the function f as a quantum gate, which will entangle the
    qubits.
4.  Measure the auxiliary qubits to obtain a set of equations that can
    be solved classically to find the hidden period s.

To examine Simon’s algorithm, we need to require the `simon` namespace
from the `application.algorithm` package.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.simon :as simon])
```

</div>

Let’s define a hidden binary string first.

<div class="sourceClojure">

``` clojure
(def hidden-string-simon [1 0 1])
```

</div>

Hidden binary string: 101

Now we can create the circuit for Simon’s algorithm.

<div class="sourceClojure">

``` clojure
(def simon-circuit
  (simon/simon-circuit hidden-string-simon))
```

</div>

We can visualize the circuit for Simon’s algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg simon-circuit))
```

</div>

<svg height="460" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="300" y="35">Simon&apos;s Algorithm</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="190" y2="190"></line></g><g><text fill="#374151" font-size="14" x="30" y="255">q3 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="250" y2="250"></line></g><g><text fill="#374151" font-size="14" x="30" y="315">q4 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="310" y2="310"></line></g><g><text fill="#374151" font-size="14" x="30" y="375">q5 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="370" y2="370"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="190" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="190" cy="250" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="182" x2="198" y1="250" y2="250"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="242" y2="258"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="130" y2="250"></line><title>CNOT: control=1, target=3</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="310" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="310" y2="310"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="302" y2="318"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="310"></line><title>CNOT: control=0, target=4</title></g><g class="gate-group"><circle cx="310" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="310" cy="310" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="302" x2="318" y1="310" y2="310"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="302" y2="318"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="190" y2="310"></line><title>CNOT: control=2, target=4</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="195">H</text><title>:h gate on qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="195">M</text><title>Measure qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="238"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="255">M</text><title>Measure qubit 3</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="298"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="315">M</text><title>Measure qubit 4</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="358"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="375">M</text><title>Measure qubit 5</title></g><g><text fill="#6b7280" font-size="12" x="30" y="430">Qubits: 6 | Gates: 9 | Depth: 6</text><text fill="#6b7280" font-size="12" x="30" y="445">Find hidden period of length 3</text></g></svg>

The circuit shows that the Hadamard gate is applied to the input qubits,
followed by the oracle function Uf. The oracle function Uf is
implemented as a series of quantum gates that applies the hidden binary
string.

Now we can execute Simon’s algorithm with the hidden binary string.

<div class="sourceClojure">

``` clojure
(def simon-result
  (simon/simon-algorithm (sim/create-simulator) hidden-string-simon {:shots 1}))
```

</div>

The result of Simon’s algorithm is a map that contains the result of the
algorithm, the measurement outcome, and the circuit used to execute the
algorithm.

<div class="sourceClojure">

``` clojure
simon-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Simon",
 :result [1 0 1],
 :hidden-period [1 0 1],
 :found-period [1 0 1],
 :measurements [[1 0 1] [0 1 0]],
 :success true,
 :linear-system
 ({:equation [1 0 1],
   :dot-product-with-hidden 0,
   :dot-product-with-found 0}
  {:equation [0 1 0],
   :dot-product-with-hidden 0,
   :dot-product-with-found 0}),
 :circuit
 {:operations
  [{:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :cnot, :operation-params {:control 1, :target 3}}
   {:operation-type :cnot, :operation-params {:control 0, :target 4}}
   {:operation-type :cnot, :operation-params {:control 2, :target 4}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [3]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [4]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [5]}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [0]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [1]}}
   {:operation-type :measure,
    :operation-params {:measurement-qubits [2]}}],
  :num-qubits 6,
  :name "Simon's Algorithm",
  :description "Find hidden period of length 3"}}
```

</div>

The result shows that Simon’s algorithm correctly identifies the hidden
binary string.

<div class="sourceClojure">

``` clojure
(:result simon-result)
```

</div>

<div class="printedClojure">

``` clojure
[1 0 1]
```

</div>

Let’s visualize the final quantum states after executing Simon’s
algorithm. As Simon’s algorithm can return multiple results, depending
on the size of the hidden string, we visualize the final states.

<div class="sourceClojure">

``` clojure
(mapv #(kind/html (viz/visualize-quantum-state :svg (:final-state %))) (:execution-results simon-result))
```

</div>

<div class="printedClojure">

``` clojure
[]
```

</div>

### Grover’s Search Algorithm

[Grover’s algorithm](https://en.wikipedia.org/wiki/Grover%27s_algorithm)
is a quantum algorithm that provides a quadratic speedup for searching
an unsorted database. It is one of the most well-known quantum
algorithms and demonstrates the power of quantum computing for search
problems.

#### Problem Statement

Given a function f: {0, 1}ⁿ → {0, 1}ⁿ that is promised to have exactly
one input x such that f(x) = 1 (the “marked” item), the goal is to find
this input x using as few evaluations of f as possible.

#### Classical Approach

In a classical setting, we would need to evaluate the function f up to
2^(n-1) times in the worst case to find the marked item. This is because
we would have to check each possible input until we find the one that
satisfies f(x) = 1.

#### Quantum Approach

Grover’s search algorithm allows us to find the marked item with only
O(√2ⁿ) evaluations of f, which is a significant improvement over the
classical approach.

#### Quantum Circuit

The Grover’s search algorithm can be implemented using a quantum circuit
with the following steps:

1.  Initialize n qubits in the state \|0⟩.
2.  Apply a Hadamard gate to all n qubits to create superposition,
    resulting in an equal superposition of all possible inputs.
3.  Apply the Grover diffusion operator, which consists of:
    - Applying the oracle function f as a quantum gate, which flips the
      sign of the amplitude of the marked item.
    - Applying a Hadamard gate to all qubits.
    - Applying a conditional phase shift to the \|0⟩ state.
    - Applying another Hadamard gate to all qubits.
4.  Repeat the Grover diffusion operator O(√2ⁿ) times.

To examine Grover’s algorithm, we need to require the `grover` namespace
from the `application.algorithm` package.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.grover :as grover])
```

</div>

Let’s define a function that marks a specific input.

<div class="sourceClojure">

``` clojure
(def grover-oracle (grover/single-target-oracle 5))
```

</div>

Now we can define a circuit with a search space of 3 qubits for Grover’s
search algorithm.

<div class="sourceClojure">

``` clojure
(def grover-circuit
  (grover/grover-circuit 3 grover-oracle))
```

</div>

Let’s visualize the circuit for Grover’s search algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg grover-circuit))
```

</div>

<svg height="280" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="1500" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="750" y="35">Grover Search</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="190" y2="190"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="190"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="130" y2="190"></line><title>Toffoli (CCX): controls=[0, 1], target=2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="75">X</text><title>:x gate on qubit 0</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="195">X</text><title>:x gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="475" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="490" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="550" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="550" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="550" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="542" x2="558" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="70" y2="190"></line><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="130" y2="190"></line><title>Toffoli (CCX): controls=[0, 1], target=2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="75">X</text><title>:x gate on qubit 0</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="655" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="670" y="195">X</text><title>:x gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="655" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="670" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="655" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="670" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="715" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="730" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="715" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="730" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="775" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="790" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="850" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="850" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="850" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="842" x2="858" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="850" x2="850" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="850" x2="850" y1="70" y2="190"></line><line stroke="#374151" stroke-width="2" x1="850" x2="850" y1="130" y2="190"></line><title>Toffoli (CCX): controls=[0, 1], target=2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="895" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="910" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="895" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="910" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="895" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="910" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="955" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="970" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="955" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="970" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="955" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="970" y="75">X</text><title>:x gate on qubit 0</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1015" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1030" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1015" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1030" y="195">X</text><title>:x gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1075" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1090" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="1150" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="1150" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="1150" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="1142" x2="1158" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="1150" x2="1150" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="1150" x2="1150" y1="70" y2="190"></line><line stroke="#374151" stroke-width="2" x1="1150" x2="1150" y1="130" y2="190"></line><title>Toffoli (CCX): controls=[0, 1], target=2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1195" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1210" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1195" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1210" y="75">X</text><title>:x gate on qubit 0</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1195" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1210" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1255" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1270" y="195">X</text><title>:x gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1255" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1270" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1255" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1270" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1315" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1330" y="195">H</text><title>:h gate on qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="195">M</text><title>Measure qubit 2</title></g><g><text fill="#6b7280" font-size="12" x="30" y="250">Qubits: 3 | Gates: 43 | Depth: 21</text><text fill="#6b7280" font-size="12" x="30" y="265">Search 8 items using 2 iterations</text></g></svg>

Now we can execute Grover’s search algorithm with the defined oracle.

<div class="sourceClojure">

``` clojure
(def grover-result
  (grover/grover-algorithm (sim/create-simulator) 8 grover-oracle {:shots 1}))
```

</div>

Like the previous algorithms, the result of Grover’s search algorithm is
a map that contains the result of the algorithm, the measurement
outcome, and the circuit used to execute the algorithm.

<div class="sourceClojure">

``` clojure
grover-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Grover",
 :execution-result
 {:job-status :completed,
  :results
  {:final-state
   {:state-vector
    [[-0.08838834764831825 0.0]
     [-0.0883883476483182 0.0]
     [-0.08838834764831825 0.0]
     [-0.0883883476483182 0.0]
     [-0.08838834764831821 0.0]
     [0.9722718241315007 0.0]
     [-0.08838834764831821 0.0]
     [-0.08838834764831821 0.0]],
    :num-qubits 3},
   :result-types #{:measurements :probabilities},
   :circuit-metadata
   {:circuit-depth 21,
    :circuit-operation-count 43,
    :circuit-gate-count 43,
    :num-qubits 3},
   :measurement-results
   {:measurement-outcomes [5],
    :measurement-probabilities
    [0.007812499999999967
     0.007812499999999957
     0.007812499999999967
     0.007812499999999957
     0.007812499999999959
     0.9453124999999959
     0.007812499999999959
     0.007812499999999959],
    :empirical-probabilities {5 1},
    :shot-count 1,
    :measurement-qubits (0 1 2),
    :frequencies {5 1}},
   :probability-results
   {:probability-outcomes
    {0 0.007812499999999967,
     1 0.007812499999999957,
     2 0.007812499999999967,
     3 0.007812499999999957,
     4 0.007812499999999959,
     5 0.9453124999999959,
     6 0.007812499999999959,
     7 0.007812499999999959},
    :target-qubits (0 1 2),
    :all-probabilities
    [0.007812499999999967
     0.007812499999999957
     0.007812499999999967
     0.007812499999999957
     0.007812499999999959
     0.9453124999999959
     0.007812499999999959
     0.007812499999999959]}},
  :execution-time-ms 8,
  :job-id "sim_job_5929_1757177346070"},
 :probability 1,
 :target-indices (5),
 :success true,
 :result 5,
 :measurement-statistics
 {:frequencies {5 1},
  :target-counts 1,
  :total-shots 1,
  :success-probability 1},
 :iterations 2,
 :circuit
 {:operations
  [{:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :toffoli,
    :operation-params {:control1 0, :control2 1, :target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 0}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :x, :operation-params {:target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :toffoli,
    :operation-params {:control1 0, :control2 1, :target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 0}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :x, :operation-params {:target 2}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :toffoli,
    :operation-params {:control1 0, :control2 1, :target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 0}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :x, :operation-params {:target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :toffoli,
    :operation-params {:control1 0, :control2 1, :target 2}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :x, :operation-params {:target 0}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :x, :operation-params {:target 2}}
   {:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}],
  :num-qubits 3,
  :name "Grover Search",
  :description "Search 8 items using 2 iterations"},
 :search-space-size 8}
```

</div>

The result shows that Grover’s search algorithm correctly identifies the
marked item.

<div class="sourceClojure">

``` clojure
(:result grover-result)
```

</div>

<div class="printedClojure">

``` clojure
5
```

</div>

#### Quantum Fourier Transform

The [Quantum Fourier Transform
(QFT)](https://en.wikipedia.org/wiki/Quantum_Fourier_transform) is a
quantum algorithm that performs the discrete Fourier transform on a
quantum state. It is a key component of many quantum algorithms,
including Shor’s algorithm.

The QFT transforms a quantum state into its frequency domain
representation, allowing us to extract periodicity and other properties
of the quantum state.

#### Problem Statement

Given a quantum state \|ψ⟩, the goal is to apply the QFT to the state
and obtain a new quantum state that represents the frequency domain of
\|ψ⟩.

#### Classical Approach

In a classical setting, the discrete Fourier transform can be computed
using classical algorithms, but it requires O(N log N) time complexity,
where N is the number of elements in the input.

#### Quantum Approach

The QFT allows us to compute the discrete Fourier transform in O(log² N)
time complexity, which is a significant improvement over the classical
approach.

#### Quantum Circuit

The QFT can be implemented using a quantum circuit with the following
steps:

1.  Initialize n qubits in the state \|ψ⟩.
2.  Apply a series of controlled phase gates to the qubits, which
    introduces phase shifts based on the relative positions of the
    qubits.
3.  Apply a series of Hadamard gates to the qubits, which creates
    superposition states that represent the frequency domain.
4.  Reverse the order of the qubits to obtain the final quantum state
    that represents the frequency domain of \|ψ⟩.

Let’s require the `quantum-fourier-transform` namespace to explore the
QFT.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.quantum-fourier-transform :as qft])
```

</div>

We can create a quantum circuit for the QFT with a specified number of
qubits.

<div class="sourceClojure">

``` clojure
(def qft-circuit
  (qft/quantum-fourier-transform-circuit 3))
```

</div>

We can visualize the circuit for the Quantum Fourier Transform.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg qft-circuit))
```

</div>

<svg height="280" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="660" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="330" y="35">QFT</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="610" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="610" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="610" y1="190" y2="190"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><circle cx="190" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="70" y2="130"></line><title>:crz gate: control=1, target=0, φ=π/2</title></g><g class="gate-group"><circle cx="250" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="235" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="250" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="190"></line><title>:crz gate: control=2, target=0, φ=π/4</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><circle cx="370" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="135">CRZ</text><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="130" y2="190"></line><title>:crz gate: control=2, target=1, φ=π/2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><line stroke="#fb923c" stroke-width="2" x1="484" x2="496" y1="64" y2="76"></line><line stroke="#fb923c" stroke-width="2" x1="484" x2="496" y1="76" y2="64"></line><line stroke="#fb923c" stroke-width="2" x1="484" x2="496" y1="184" y2="196"></line><line stroke="#fb923c" stroke-width="2" x1="484" x2="496" y1="196" y2="184"></line><line stroke="#fb923c" stroke-width="2" x1="490" x2="490" y1="70" y2="190"></line><title>SWAP: qubits 0 and 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="615" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="630" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="615" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="630" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="615" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="630" y="195">M</text><title>Measure qubit 2</title></g><g><text fill="#6b7280" font-size="12" x="30" y="250">Qubits: 3 | Gates: 7 | Depth: 7</text><text fill="#6b7280" font-size="12" x="30" y="265">Quantum Fourier Transform</text></g></svg>

The circuit shows that the QFT applies a series of controlled phase
gates and Hadamard gates to the qubits, transforming the quantum state
into its frequency domain representation.

<div class="sourceClojure">

``` clojure
(def qft-result
  (qb/execute-circuit (sim/create-simulator) qft-circuit {:shots 1}))
```

</div>

<div class="sourceClojure">

``` clojure
qft-result
```

</div>

<div class="printedClojure">

``` clojure
{:job-status :completed,
 :results
 {:final-state
  {:num-qubits 3,
   :state-vector
   [[0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]
    [0.3535533905932737 0.0]]},
  :result-types #{},
  :circuit-metadata
  {:circuit-depth 7,
   :circuit-operation-count 7,
   :circuit-gate-count 7,
   :num-qubits 3}},
 :execution-time-ms 3,
 :job-id "sim_job_5930_1757177346182"}
```

</div>

The circuit for the QFT can also be used to implement the inverse QFT,
which is the reverse operation of the QFT.

<div class="sourceClojure">

``` clojure
(def inverse-qft-circuit
  (qft/inverse-quantum-fourier-transform-circuit 3))
```

</div>

We can visualize the circuit for the inverse Quantum Fourier Transform.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg inverse-qft-circuit))
```

</div>

<svg height="280" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="300" y="35">QFT (inverse)</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="550" y1="190" y2="190"></line></g><g class="gate-group"><line stroke="#fb923c" stroke-width="2" x1="124" x2="136" y1="64" y2="76"></line><line stroke="#fb923c" stroke-width="2" x1="124" x2="136" y1="76" y2="64"></line><line stroke="#fb923c" stroke-width="2" x1="124" x2="136" y1="184" y2="196"></line><line stroke="#fb923c" stroke-width="2" x1="124" x2="136" y1="196" y2="184"></line><line stroke="#fb923c" stroke-width="2" x1="130" x2="130" y1="70" y2="190"></line><title>SWAP: qubits 0 and 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="250" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="235" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="250" y="135">CRZ</text><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="130" y2="190"></line><title>:crz gate: control=2, target=1, φ=π/2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><circle cx="370" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="70" y2="190"></line><title>:crz gate: control=2, target=0, φ=π/4</title></g><g class="gate-group"><circle cx="430" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="430" x2="430" y1="70" y2="130"></line><title>:crz gate: control=1, target=0, φ=π/2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="475" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="490" y="75">H</text><title>:h gate on qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="555" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="570" y="195">M</text><title>Measure qubit 2</title></g><g><text fill="#6b7280" font-size="12" x="30" y="250">Qubits: 3 | Gates: 7 | Depth: 6</text><text fill="#6b7280" font-size="12" x="30" y="265">Quantum Fourier Transform</text></g></svg>

The inverse QFT circuit applies the inverse operations of the controlled
phase gates and Hadamard gates to the qubits, transforming the quantum
state back to its original representation. The inverse QFT can be used
to recover the original quantum state from its frequency domain
representation.

### Quantum Phase Estimation

The [Quantum Phase Estimation
(QPE)](https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm)
is a quantum algorithm that estimates the eigenvalues of a unitary
operator. It is used in many quantum algorithms, including Shor’s
algorithm and the Quantum Fourier Transform.

#### Problem Statement

Given a unitary operator U and an eigenstate \|ψ⟩ of U, the goal is to
estimate the phase θ such that U\|ψ⟩ = e^(2πiθ)\|ψ⟩, where θ is the
eigenvalue of U.

#### Classical Approach

In a classical setting, estimating the phase of a unitary operator
requires multiple evaluations of the operator and can be computationally
expensive.

#### Quantum Approach

The Quantum Phase Estimation algorithm allows us to estimate the phase θ
with high precision using a quantum circuit that requires only a
polynomial number of evaluations of the unitary operator U.

#### Quantum Circuit

The Quantum Phase Estimation algorithm can be implemented using a
quantum circuit with the following steps:

1.  Initialize n qubits in the state \|0⟩ and an auxiliary qubit in the
    state \|ψ⟩.
2.  Apply a Hadamard gate to the auxiliary qubit to create
    superposition.
3.  Apply controlled-U gates to the auxiliary qubit, where U is the
    unitary operator.
4.  Apply the inverse Quantum Fourier Transform (QFT) to the auxiliary
    qubit.
5.  Measure the auxiliary qubit to obtain the estimated phase θ.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.quantum-phase-estimation :as qpe])
```

</div>

### Quantum Period Finding

The [Quantum Period
Finding](https://en.wikipedia.org/wiki/Quantum_period_finding) is a
quantum algorithm that finds the period of a function. It is used in
many quantum algorithms, including Shor’s algorithm and the Quantum
Fourier Transform

#### Problem Statement

Given a function f: {0, 1}ⁿ → {0, 1}ⁿ that is periodic with period r,
the goal is to find the period r using as few evaluations of f as
possible.

#### Classical Approach

In a classical setting, finding the period of a function requires
multiple evaluations of the function and can be computationally
expensive.

#### Quantum Approach

The Quantum Period Finding algorithm allows us to find the period r with
high precision using a quantum circuit that requires only a polynomial
number of evaluations of the function f.

#### Quantum Circuit

The Quantum Period Finding algorithm can be implemented using a quantum
circuit with the following steps:

1.  Initialize n qubits in the state \|0⟩ and an auxiliary qubit in the
    state \|1⟩.
2.  Apply a Hadamard gate to all n qubits to create superposition.
3.  Apply the function f as a quantum gate, which will entangle the
    qubits.
4.  Apply the Quantum Fourier Transform (QFT) to the qubits.
5.  Measure the qubits to obtain a value that can be used to find the
    period r.

To explore the Quantum Period Finding algorithm, we need to require the
`quantum-period-finding` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.quantum-period-finding :as qpf])
```

</div>

### Shor’s Algorithm

[Shor’s algorithm](https://en.wikipedia.org/wiki/Shor%27s_algorithm) is
a quantum algorithm that can factor large integers in polynomial time.
It is one of the most famous quantum algorithms and has significant
implications for cryptography, as it can break many classical encryption
schemes. Shor’s algorithm uses the Quantum Fourier Transform and Quantum
Phase Estimation to find the period of a function related to the integer
to be factored.

Shor’s algorithm uses lots of qubits and is thus not really feasible to
run on current quantum hardware and simulators. For small integers, it
can be run on simulators, but the results may not be very interesting.
For a n-bit integer, Shor’s algorithm requires at least about 2n + 3
qubits.

#### Problem Statement

Given a composite integer N, the goal is to find its prime factors using
as few evaluations of a function as possible.

#### Classical Approach

In a classical setting, factoring large integers is a computationally
hard problem. The best-known classical algorithms for factoring have
exponential time complexity, making them impractical for large N.

#### Quantum Approach

Shor’s algorithm allows us to factor large integers in polynomial time
by leveraging quantum superposition, interference, and the quantum
Fourier transform.

#### Quantum Circuit

The Shor’s algorithm can be implemented using a quantum circuit with the
following steps:

1.  Choose a random integer a such that 1 \< a \< N.
2.  Use the quantum period-finding algorithm to find the order r of a
    modulo N. This involves:
    - Initialize n qubits in the state \|0⟩.
    - Apply a Hadamard gate to all n qubits to create superposition.
    - Apply the modular exponentiation function a^x mod N as a quantum
      gate, which will entangle the qubits.
    - Apply the quantum Fourier transform to the qubits.
    - Measure the qubits to obtain a value that can be used to find the
      order r.
3.  If r is even and a^(r/2) != -1 mod N, then compute the factors:
    - Compute gcd(a^(r/2) - 1, N and gcd(a^(r/2) + 1, N).
4.  If the factors are non-trivial, return them as the prime factors of
    N.
5.  If the order r is odd or if the above conditions are not met, repeat
    the process with a different random integer a.

Let’s examine Shor’s algorithm by requiring the `shor` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.shor :as shor])
```

</div>

We can use Shor’s algorithm to factor a composite integer, e.g. 15. The
algorithm should return the prime factors 3 and 5, may run for quite a
while depending on the random numbers chosen.

(def shor-result (shor/shor-algorithm (sim/create-simulator) 15 {:shots
10}))

The result of Shor’s algorithm is a map that contains the result of the
algorithm, the measurement outcome, and the circuit used to execute the
algorithm.

shor-result

The result shows that Shor’s algorithm correctly factors the composite
integer 15 into its prime factors 3 and 5. The measurement outcome is
the prime factors of 15, which are 3 and 5.

(:result shor-result)

### HHL Algorithm

The [HHL algorithm](https://en.wikipedia.org/wiki/HHL_algorithm) is a
quantum algorithm for solving linear systems of equations. It is named
after its inventors Harrow, Hassidim, and Lloyd. The HHL algorithm can
solve a system of linear equations in polynomial time, which is a
significant improvement over classical algorithms that require
exponential time for large systems. The result is an approximation of
the solution vector x that satisfies the equations Ax = b, where A is a
hermitian matrix and b is a vector of constants.

The current implementation works for a hermitian n x n matrix A and a
vector b.

#### Problem Statement

Given a system of linear equations Ax = b, where A is a hermitian
matrix, x is the vector of unknowns, and b is the vector of constants,
the goal is to find the vector x that satisfies the equations using as
few evaluations of the matrix A as possible.

#### Classical Approach

In a classical setting, solving a system of linear equations requires
O(N³) time complexity, where N is the number of equations in the system.
Classical algorithms such as Gaussian elimination or LU decomposition
can be used to solve the system, but they are computationally expensive
for large systems.

#### Quantum Approach

The HHL algorithm allows us to solve a system of linear equations in
O(log N) time complexity by leveraging quantum superposition,
interference, and the quantum Fourier transform.

#### Quantum Circuit

The HHL algorithm can be implemented using a quantum circuit with the
following steps:

1.  Prepare the input state \|b⟩, which represents the vector of
    constants b.
2.  Use the quantum phase estimation algorithm to estimate the
    eigenvalues of the matrix A. This involves:
    - Initialize n qubits in the state \|0⟩.
    - Apply a Hadamard gate to all n qubits to create superposition.
    - Apply controlled-U gates to the qubits, where U is the unitary
      operator that represents the matrix A.
    - Apply the inverse quantum Fourier transform to the qubits.
    - Measure the qubits to obtain the estimated eigenvalues of A.
3.  Use the estimated eigenvalues to compute the inverse of the matrix
    A.
4.  Apply the inverse of the matrix A to the input state \|b⟩ to obtain
    the output state \|x⟩, which represents the solution to the system
    of linear equations Ax = b.
5.  Measure the output state \|x⟩ to obtain the vector of unknowns x
    that satisfies the equations.

Let’s examine the HHL algorithm by requiring the `hhl` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.hhl :as hhl])
```

</div>

We can use the HHL algorithm to solve a system of linear equations. For
example, let’s solve the system of equations represented by the positive
definite matrix A and the vector b.

IMPORTANT: HHL works best with positive definite hermitian matrices (all
eigenvalues \> 0).

Positive definite matrix A

<div class="sourceClojure">

``` clojure
(def hhl-matrix [[3 1] [1 2]])
```

</div>

Vector b

<div class="sourceClojure">

``` clojure
(def hhl-vector [7 5])
```

</div>

Now we can create the circuit for the HHL algorithm with the given
matrix and vector.

<div class="sourceClojure">

``` clojure
(def hhl-circuit
  (hhl/hhl-circuit hhl-matrix hhl-vector 4 1))
```

</div>

We can visualize the circuit for the HHL algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg hhl-circuit))
```

</div>

<svg height="460" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="840" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="420" y="35">Working HHL Algorithm</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="190" y2="190"></line></g><g><text fill="#374151" font-size="14" x="30" y="255">q3 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="250" y2="250"></line></g><g><text fill="#374151" font-size="14" x="30" y="315">q4 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="310" y2="310"></line></g><g><text fill="#374151" font-size="14" x="30" y="375">q5 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="370" y2="370"></line></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">RY</text><title>:ry gate on qubit 0, θ=1.24 (0.395π)</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="238"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="255">H</text><title>:h gate on qubit 3</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="298"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="315">H</text><title>:h gate on qubit 4</title></g><g class="gate-group"><circle cx="190" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="70" y2="130"></line><title>:crz gate: control=1, target=0, φ=0.3 (0.095π)</title></g><g class="gate-group"><circle cx="250" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="235" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="250" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="190"></line><title>:crz gate: control=2, target=0, φ=0.6 (0.191π)</title></g><g class="gate-group"><circle cx="310" cy="250" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="70" y2="250"></line><title>:crz gate: control=3, target=0, φ=1.2 (0.382π)</title></g><g class="gate-group"><circle cx="370" cy="310" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="355" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="370" y="75">CRZ</text><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="70" y2="310"></line><title>:crz gate: control=4, target=0, φ=2.4 (0.764π)</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="358"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="375">RY</text><title>:ry gate on qubit 5, θ=0.393 (0.125π)</title></g><g class="gate-group"><circle cx="430" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="358"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="375">CRY</text><line stroke="#374151" stroke-width="2" x1="430" x2="430" y1="130" y2="370"></line><title>:cry gate: control=1, target=5, θ=π/2</title></g><g class="gate-group"><circle cx="490" cy="190" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="475" y="358"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="490" y="375">CRY</text><line stroke="#374151" stroke-width="2" x1="490" x2="490" y1="190" y2="370"></line><title>:cry gate: control=2, target=5, θ=π/3</title></g><g class="gate-group"><circle cx="550" cy="250" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="535" y="358"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="550" y="375">CRY</text><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="250" y2="370"></line><title>:cry gate: control=3, target=5, θ=π/4</title></g><g class="gate-group"><circle cx="610" cy="310" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="358"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="375">CRY</text><line stroke="#374151" stroke-width="2" x1="610" x2="610" y1="310" y2="370"></line><title>:cry gate: control=4, target=5, θ=0.628 (0.2π)</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="655" y="298"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="670" y="315">H</text><title>:h gate on qubit 4</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="238"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="255">H</text><title>:h gate on qubit 3</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="535" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="550" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="475" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="490" y="135">H</text><title>:h gate on qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="195">M</text><title>Measure qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="238"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="255">M</text><title>Measure qubit 3</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="298"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="315">M</text><title>Measure qubit 4</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="358"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="375">M</text><title>Measure qubit 5</title></g><g><text fill="#6b7280" font-size="12" x="30" y="430">Qubits: 6 | Gates: 18 | Depth: 10</text><text fill="#6b7280" font-size="12" x="30" y="445">Functional HHL for 2×2 matrix</text></g></svg>

The circuit shows that the HHL algorithm applies a series of
controlled-U gates to the qubits, which represent the matrix A, and
applies the inverse quantum Fourier transform to the qubits. The circuit
also applies the inverse of the matrix A to the input state \|b⟩ to
obtain the output state \|x⟩, which represents the solution to the
system of linear equations Ax = b.

<div class="sourceClojure">

``` clojure
(def hhl-result
  (hhl/hhl-algorithm (sim/create-simulator)
                     hhl-matrix
                     hhl-vector
                     {:shots 10000}))
```

</div>

The result of the HHL algorithm is a map that contains the result of the
algorithm, the measurement outcome, and the circuit used to execute the
algorithm. We don’t show the full result here, as it contains 20000
measurement outcomes for the 20000 shots requested. We only show the
probability results and the final result.

<div class="sourceClojure">

``` clojure
(get-in hhl-result [:execution-result :results :probability-results])
```

</div>

<div class="printedClojure">

``` clojure
{:probability-outcomes
 {0 0.15670125878642163,
  62 2.935927677620301E-4,
  7 0.012332924504854964,
  59 0.001036013325433737,
  20 0.0035966795732933782,
  58 0.001007387238289471,
  60 3.2860055681845963E-4,
  27 0.0020305861178501246,
  1 0.17207148706378567,
  24 0.0023017184830934857,
  55 0.0015417180055429785,
  39 0.006292308420844369,
  46 0.0011599815215200028,
  4 0.014126966354813652,
  54 0.0015746061568597976,
  15 0.002254532527345905,
  48 0.013113194036970206,
  50 0.007028845712803338,
  21 0.0034528645878414746,
  31 5.786026804023501E-4,
  32 0.07994962182980689,
  40 0.005362295397107446,
  56 0.0011743461648436116,
  33 0.08779157503254365,
  13 0.00252667350667409,
  22 0.003086228067445202,
  36 0.00720763589531308,
  41 0.004977762617291755,
  43 0.00401822937090493,
  61 3.3219852394926784E-4,
  29 6.511091069405663E-4,
  44 0.00131078220399193,
  6 0.011944811403382492,
  28 6.440570913641818E-4,
  51 0.0064450607988867925,
  25 0.002426896096956261,
  34 0.032531303055072736,
  17 0.023149055866472274,
  3 0.07065060025023143,
  12 0.0025691331198241826,
  2 0.06376135398794261,
  23 0.0030217672908642375,
  47 0.0011502716976254615,
  35 0.036046224617465,
  19 0.012632319165818117,
  57 0.001238212294365435,
  11 0.007875729566973664,
  9 0.009756414729891838,
  5 0.014992864704205184,
  14 0.002273563782179206,
  45 0.0012891191360582105,
  53 0.001761665606041567,
  26 0.0019744789870473627,
  16 0.025701860312461595,
  38 0.006094291532338006,
  30 5.754418248135803E-4,
  10 0.008213546045545387,
  18 0.013776537597094544,
  52 0.001835040598619066,
  42 0.004190584717114991,
  37 0.007649420767451619,
  63 2.952054491848731E-4,
  8 0.010510098978330603,
  49 0.011810742789016474},
 :target-qubits (0 1 2 3 4 5),
 :all-probabilities
 [0.15670125878642163
  0.17207148706378567
  0.06376135398794261
  0.07065060025023143
  0.014126966354813652
  0.014992864704205184
  0.011944811403382492
  0.012332924504854964
  0.010510098978330603
  0.009756414729891838
  0.008213546045545387
  0.007875729566973664
  0.0025691331198241826
  0.00252667350667409
  0.002273563782179206
  0.002254532527345905
  0.025701860312461595
  0.023149055866472274
  0.013776537597094544
  0.012632319165818117
  0.0035966795732933782
  0.0034528645878414746
  0.003086228067445202
  0.0030217672908642375
  0.0023017184830934857
  0.002426896096956261
  0.0019744789870473627
  0.0020305861178501246
  6.440570913641818E-4
  6.511091069405663E-4
  5.754418248135803E-4
  5.786026804023501E-4
  0.07994962182980689
  0.08779157503254365
  0.032531303055072736
  0.036046224617465
  0.00720763589531308
  0.007649420767451619
  0.006094291532338006
  0.006292308420844369
  0.005362295397107446
  0.004977762617291755
  0.004190584717114991
  0.00401822937090493
  0.00131078220399193
  0.0012891191360582105
  0.0011599815215200028
  0.0011502716976254615
  0.013113194036970206
  0.011810742789016474
  0.007028845712803338
  0.0064450607988867925
  0.001835040598619066
  0.001761665606041567
  0.0015746061568597976
  0.0015417180055429785
  0.0011743461648436116
  0.001238212294365435
  0.001007387238289471
  0.001036013325433737
  3.2860055681845963E-4
  3.3219852394926784E-4
  2.935927677620301E-4
  2.952054491848731E-4]}
```

</div>

<div class="sourceClojure">

``` clojure
(:result hhl-result)
```

</div>

<div class="printedClojure">

``` clojure
[1.9363255703434703 1.3841772257283993]
```

</div>

The result shows that the HHL algorithm correctly aproximates the
solution of the system of linear equations represented by the matrix A
and the vector b.

The measurement outcome is an approximation to the vector of unknowns x
that satisfies the equations.

Let’s visualize the final quantum state after executing the HHL
algorithm.

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-quantum-state :svg (get-in hhl-result [:execution-result :results :final-state])))
```

</div>

<svg height="400" style="background-color: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px;" width="600" xmlns="http://www.w3.org/2000/svg"><defs><style>text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }
                   rect:hover { opacity: 1; stroke-width: 2; }</style></defs><text fill="#111827" font-size="16" font-weight="bold" text-anchor="middle" x="300" y="25">Quantum State Probability Distribution (6 qubits)</text><text fill="#374151" font-size="12" text-anchor="middle" transform="rotate(-90 20 200)" x="20" y="200">Probability (%)</text><text fill="#374151" font-size="12" text-anchor="middle" x="300" y="390">Basis States</text><g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="80" y1="60" y2="280"></line><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="280.0" y2="280.0"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="283.0">0%</text></g><g><line stroke="#9ca3af" stroke-width="1" x1="75" x2="80" y1="152.14616218290274" y2="152.14616218290274"></line><text fill="#6b7280" font-size="10" text-anchor="end" x="70" y="155.14616218290274">10%</text></g></g><line stroke="#9ca3af" stroke-width="1" x1="80" x2="560" y1="280" y2="280"></line><g class="bar-group"><rect fill="#7c3aed" height="220.0" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="80" y="60.0"><title>|000001⟩: 17.2%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 95 300)" x="95" y="300">|000001⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="95" y="55.0">17.2%</text></g><g class="bar-group"><rect fill="#3b82f6" height="200.34857326614136" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="110" y="79.65142673385864"><title>|000000⟩: 15.7%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 125 300)" x="125" y="300">|000000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="125" y="74.65142673385864">15.7%</text></g><g class="bar-group"><rect fill="#10b981" height="112.2448979591836" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="140" y="167.75510204081638"><title>|100001⟩: 8.8%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 155 300)" x="155" y="300">|100001⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="155" y="162.75510204081638">8.8%</text></g><g class="bar-group"><rect fill="#f59e0b" height="102.21865982966388" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="170" y="177.78134017033614"><title>|100000⟩: 8.0%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 185 300)" x="185" y="300">|100000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="185" y="172.78134017033614">8.0%</text></g><g class="bar-group"><rect fill="#ef4444" height="90.3295038607366" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="200" y="189.6704961392634"><title>|000011⟩: 7.1%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 215 300)" x="215" y="300">|000011⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="215" y="184.6704961392634">7.1%</text></g><g class="bar-group"><rect fill="#8b5cf6" height="81.52133811772941" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="230" y="198.4786618822706"><title>|000010⟩: 6.4%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 245 300)" x="245" y="300">|000010⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="245" y="193.4786618822706">6.4%</text></g><g class="bar-group"><rect fill="#06b6d4" height="46.08648156160028" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="260" y="233.9135184383997"><title>|100011⟩: 3.6%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 275 300)" x="275" y="300">|100011⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="275" y="228.9135184383997">3.6%</text></g><g class="bar-group"><rect fill="#84cc16" height="41.5925194478211" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="290" y="238.4074805521789"><title>|100010⟩: 3.3%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 305 300)" x="305" y="300">|100010⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="305" y="233.4074805521789">3.3%</text></g><g class="bar-group"><rect fill="#7c3aed" height="32.860814799871534" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="320" y="247.13918520012845"><title>|010000⟩: 2.6%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 335 300)" x="335" y="300">|010000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="335" y="242.13918520012845">2.6%</text></g><g class="bar-group"><rect fill="#3b82f6" height="29.596956343708698" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="350" y="250.4030436562913"><title>|010001⟩: 2.3%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 365 300)" x="365" y="300">|010001⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="365" y="245.4030436562913">2.3%</text></g><g class="bar-group"><rect fill="#10b981" height="19.168952923051314" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="380" y="260.8310470769487"><title>|000101⟩: 1.5%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 395 300)" x="395" y="300">|000101⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="395" y="255.83104707694872">1.5%</text></g><g class="bar-group"><rect fill="#f59e0b" height="18.061868651759344" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="410" y="261.93813134824063"><title>|000100⟩: 1.4%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 425 300)" x="425" y="300">|000100⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="425" y="256.93813134824063">1.4%</text></g><g class="bar-group"><rect fill="#ef4444" height="17.613832036200684" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="440" y="262.3861679637993"><title>|010010⟩: 1.4%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 455 300)" x="455" y="300">|010010⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="455" y="257.3861679637993">1.4%</text></g><g class="bar-group"><rect fill="#8b5cf6" height="16.765721836669154" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="470" y="263.2342781633308"><title>|110000⟩: 1.3%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 485 300)" x="485" y="300">|110000⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="485" y="258.2342781633308">1.3%</text></g><g class="bar-group"><rect fill="#06b6d4" height="16.150904858803187" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="500" y="263.8490951411968"><title>|010011⟩: 1.3%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 515 300)" x="515" y="300">|010011⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="515" y="258.8490951411968">1.3%</text></g><g class="bar-group"><rect fill="#84cc16" height="15.76811729454231" opacity="0.8" stroke="#ffffff" stroke-width="1" width="28" x="530" y="264.2318827054577"><title>|000111⟩: 1.2%</title></rect><text fill="#374151" font-size="12" text-anchor="end" transform="rotate(-45 545 300)" x="545" y="300">|000111⟩</text><text fill="#6b7280" font-size="10" text-anchor="middle" x="545" y="259.2318827054577">1.2%</text></g></svg>

The final quantum state shows the approximation of the solution of the
system of linear equations Ax = b. The final quantum state is a
superposition of the states that represent the solution to the system of
equations.

<div class="sourceClojure">

``` clojure
(hhl/solve (sim/create-simulator)
           hhl-matrix
           hhl-vector
           {:shots 10000})
```

</div>

<div class="printedClojure">

``` clojure
[1.9436546199020608 1.3721377659513005]
```

</div>

### Variational Quantum Eigensolver (VQE) Algorithm

The [Variational Quantum Eigensolver
(VQE)](https://en.wikipedia.org/wiki/Variational_quantum_eigensolver) is
a hybrid quantum-classical algorithm used to find the ground state
energy of a quantum system. It is particularly useful for simulating
molecular systems and materials, where the Hamiltonian of the system can
be represented as a sum of Pauli operators.

The VQE algorithm is also used in quantum machine learning and
optimization problems, where it can be used to find the optimal
parameters for a quantum circuit that represents a trial state.

The VQE algorithm uses a parameterized quantum circuit to prepare a
trial state, and a classical optimization algorithm to minimize the
expectation value of the Hamiltonian with respect to the trial state.

#### Problem Statement

Given a Hamiltonian H of a quantum system, the goal is to find the
ground state energy E₀ of the system, which is the lowest eigenvalue of
H, using as few evaluations of the Hamiltonian as possible.

#### Classical Approach

In a classical setting, finding the ground state energy of a quantum
system requires solving the eigenvalue problem for the Hamiltonian H,
which can be computationally expensive for large systems. Classical
algorithms such as diagonalization or iterative methods can be used to
find the ground state energy, but they are limited by the size of the
system and the complexity of the Hamiltonian.

#### Quantum Approach

The VQE algorithm allows us to find the ground state energy of a quantum
system using a hybrid quantum-classical approach. It leverages the power
of quantum computing to prepare trial states and measure the expectation
value of the Hamiltonian, while using classical optimization algorithms
to minimize the expectation value and find the optimal parameters for
the trial state.

#### Quantum Circuit

The VQE algorithm can be implemented using a quantum circuit with the
following steps:

1.  Prepare a parameterized quantum circuit that represents the trial
    state. The circuit can be represented as a series of quantum gates
    that depend on a set of parameters θ.
2.  Initialize the parameters θ to some initial values.
3.  Execute the quantum circuit to prepare the trial state \|ψ(θ)⟩.
4.  Measure the expectation value of the Hamiltonian H with respect to
    the trial state \|ψ(θ)⟩. This involves applying the Hamiltonian as a
    quantum gate and measuring the qubits to obtain the expectation
    value ⟨H⟩.
5.  Use a classical optimization algorithm to update the parameters θ
    based on the measured expectation value ⟨H⟩. The optimization
    algorithm can be gradient-based or gradient-free, depending on the
    problem.
6.  Repeat steps 3-5 until convergence, i.e., until the expectation
    value ⟨H⟩ does not change significantly or a maximum number of
    iterations is reached.
7.  The final expectation value ⟨H⟩ represents the ground state energy
    E₀ of the quantum system.

To explore the VQE algorithm, we need to require the
`variational-quantum-eigensolver` namespace from the
`application.algorithm` package. To create a simple Hamiltonian, we also
require the `domain.hamiltonian` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.domain.hamiltonian :as ham])
```

</div>

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.vqe :as vqe])
```

</div>

Let’s start with a simpler Hamiltonian for demonstration, which can be
represented as a sum of Pauli operators.

<div class="sourceClojure">

``` clojure
(def simple-hamiltonian [(ham/pauli-term -1.0 "IIII")
                         (ham/pauli-term 0.1 "ZIII")])
```

</div>

<div class="sourceClojure">

``` clojure
simple-hamiltonian
```

</div>

<div class="printedClojure">

``` clojure
[{:coefficient -1.0, :pauli-string "IIII"}
 {:coefficient 0.1, :pauli-string "ZIII"}]
```

</div>

Let’s run the VQE algorithm with the simple Hamiltonian. We’ll use the
hardware-efficient ansatz and the gradient descent optimizer with
parameter shift gradients.

<div class="sourceClojure">

``` clojure
(def simple-vqe-result
  (vqe/variational-quantum-eigensolver
   (sim/create-simulator)
   {:hamiltonian simple-hamiltonian
    :ansatz-type :hardware-efficient
    :num-qubits 4
    :num-layers 1
    :max-iterations 200
    :tolerance 1e-4
    :optimization-method :gradient-descent  ; Use gradient descent optimization
    :learning-rate 0.01
    :shots 1}))
```

</div>

<div class="sourceClojure">

``` clojure
simple-vqe-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Variational Quantum Eigensolver",
 :config
 {:ansatz-type :hardware-efficient,
  :optimization-method :gradient-descent,
  :tolerance 1.0E-4,
  :max-iterations 200,
  :shots 1,
  :num-qubits 4,
  :hamiltonian
  [{:coefficient -1.0, :pauli-string "IIII"}
   {:coefficient 0.1, :pauli-string "ZIII"}],
  :learning-rate 0.01,
  :num-layers 1},
 :ansatz-type :hardware-efficient,
 :optimization
 {:success true,
  :reason :converged,
  :optimal-energy -0.9000158858879099,
  :optimal-parameters
  [0.007957354956639082
   -0.015950299137366966
   -0.03403685641709444
   -0.025298081927249153
   -0.013357082534186302
   0.04382015443217935
   0.015096277877583898
   0.016489445703013462
   0.007173582180421536
   0.013566987503183634
   0.031128642492288985
   0.024877572511750448],
  :iterations 2,
  :history
  [{:iteration 0,
    :energy -0.9000158225111071,
    :gradients
    [-7.940376652492143E-4
     0.0015917274462338704
     5.551115123125783E-17
     -1.6653345369377348E-16
     -2.220446049250313E-16
     0.0
     -2.220446049250313E-16
     1.1102230246251565E-16
     -5.551115123125783E-17
     5.551115123125783E-17
     1.1102230246251565E-16
     5.551115123125783E-17],
    :parameters
    [0.00794146626622917
     -0.015918448674693598
     -0.03403685641709444
     -0.025298081927249153
     -0.013357082534186306
     0.04382015443217935
     0.015096277877583898
     0.016489445703013462
     0.007173582180421534
     0.013566987503183636
     0.031128642492288985
     0.024877572511750448]}
   {:iteration 1,
    :energy -0.9000158541678444,
    :gradients
    [-7.948313757419889E-4
     0.001593318821102807
     5.551115123125783E-17
     1.6653345369377348E-16
     -1.6653345369377348E-16
     0.0
     1.1102230246251565E-16
     0.0
     -5.551115123125783E-17
     1.1102230246251565E-16
     1.1102230246251565E-16
     0.0],
    :parameters
    [0.007949406642881662
     -0.015934365949155937
     -0.03403685641709444
     -0.025298081927249153
     -0.013357082534186304
     0.04382015443217935
     0.0150962778775839
     0.016489445703013462
     0.007173582180421535
     0.013566987503183636
     0.031128642492288985
     0.024877572511750448]}
   {:iteration 2,
    :energy -0.9000158858879099,
    :gradients
    [-7.95625878963091E-4
     0.0015949117862882334
     1.1102230246251565E-16
     5.551115123125783E-17
     -2.7755575615628914E-16
     0.0
     -1.1102230246251565E-16
     -1.6653345369377348E-16
     -5.551115123125783E-17
     0.0
     -5.551115123125783E-17
     -5.551115123125783E-17],
    :parameters
    [0.007957354956639082
     -0.015950299137366966
     -0.03403685641709444
     -0.025298081927249153
     -0.013357082534186302
     0.04382015443217935
     0.015096277877583898
     0.016489445703013462
     0.007173582180421536
     0.013566987503183634
     0.031128642492288985
     0.024877572511750448]}],
  :convergence-analysis
  {:converged true,
   :energy-converged false,
   :gradient-converged false,
   :parameter-stable true,
   :current-energy -0.9000158858879099,
   :gradient-norm 0.0017823479304885773,
   :iterations 3,
   :recommendation :stop-converged}},
 :success true,
 :analysis
 {:initial-energy -0.9000158225111071,
  :energy-improvement 6.337680280577018E-8,
  :convergence-achieved true},
 :result -0.9000158858879099,
 :timing
 {:execution-time-ms 1416,
  :start-time 1757177346940,
  :end-time 1757177348356},
 :circuit
 {:operations
  [{:operation-type :rx,
    :operation-params {:target 0, :angle 0.007957354956639082}}
   {:operation-type :ry,
    :operation-params {:target 0, :angle -0.015950299137366966}}
   {:operation-type :rz,
    :operation-params {:target 0, :angle -0.03403685641709444}}
   {:operation-type :rx,
    :operation-params {:target 1, :angle -0.025298081927249153}}
   {:operation-type :ry,
    :operation-params {:target 1, :angle -0.013357082534186302}}
   {:operation-type :rz,
    :operation-params {:target 1, :angle 0.04382015443217935}}
   {:operation-type :rx,
    :operation-params {:target 2, :angle 0.015096277877583898}}
   {:operation-type :ry,
    :operation-params {:target 2, :angle 0.016489445703013462}}
   {:operation-type :rz,
    :operation-params {:target 2, :angle 0.007173582180421536}}
   {:operation-type :rx,
    :operation-params {:target 3, :angle 0.013566987503183634}}
   {:operation-type :ry,
    :operation-params {:target 3, :angle 0.031128642492288985}}
   {:operation-type :rz,
    :operation-params {:target 3, :angle 0.024877572511750448}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :cnot, :operation-params {:control 2, :target 3}}],
  :num-qubits 4,
  :name "Hardware Efficient Ansatz"},
 :parameter-count 12,
 :hamiltonian {:terms 2, :grouped-terms nil, :classical-bound nil},
 :results
 {:optimal-energy -0.9000158858879099,
  :optimal-parameters
  [0.007957354956639082
   -0.015950299137366966
   -0.03403685641709444
   -0.025298081927249153
   -0.013357082534186302
   0.04382015443217935
   0.015096277877583898
   0.016489445703013462
   0.007173582180421536
   0.013566987503183634
   0.031128642492288985
   0.024877572511750448],
  :success true,
  :iterations 2,
  :function-evaluations nil}}
```

</div>

We can use the VQE algorithm to find the ground state energy of a
quantum system. For example, let’s find the ground state energy of
molecular hydrogen, for which the Hamiltonian can be represented as a
sum of Pauli operators.

<div class="sourceClojure">

``` clojure
(def h2-hamiltonian (vqe/molecular-hydrogen-hamiltonian))
```

</div>

<div class="sourceClojure">

``` clojure
h2-hamiltonian
```

</div>

<div class="printedClojure">

``` clojure
[{:coefficient -1.1395602, :pauli-string "IIII"}
 {:coefficient 0.39793742, :pauli-string "IIIZ"}
 {:coefficient -0.39793742, :pauli-string "IIZI"}
 {:coefficient 0.39793742, :pauli-string "IZII"}
 {:coefficient -0.39793742, :pauli-string "ZIII"}
 {:coefficient -0.0112801, :pauli-string "IIZZ"}
 {:coefficient -0.0112801, :pauli-string "IZIZ"}
 {:coefficient -0.0112801, :pauli-string "IZZI"}
 {:coefficient -0.0112801, :pauli-string "ZIIZ"}
 {:coefficient -0.0112801, :pauli-string "ZIZI"}
 {:coefficient -0.0112801, :pauli-string "ZZZZ"}
 {:coefficient -0.1809312, :pauli-string "XXII"}
 {:coefficient -0.1809312, :pauli-string "YYII"}
 {:coefficient -0.1809312, :pauli-string "IIXX"}
 {:coefficient -0.1809312, :pauli-string "IIYY"}]
```

</div>

Let’s run the VQE algorithm with the defined Hamiltonian. The result of
the VQE algorithm is a map that contains the result of the algorithm,
the measurement outcome, and the circuit used to execute the algorithm.

There are different ansatz types available, such as
`:hardware-efficient`, `:chemistry-inspired`, `:uccsd`,
`:symmetry-preserving` and `:custom`. The `:hardware-efficient` ansatz
type is not suitable for chemistry problems, as it does not preserve the
symmetries of the Hamiltonian. The `:uccsd` ansatz type is suitable for
chemistry problems, as it uses the unitary coupled cluster ansatz. The
`:symmetry-preserving` ansatz type is suitable for chemistry problems,
as it preserves the symmetries of the Hamiltonian. The `:custom` ansatz
type allows you to define your own ansatz circuit.

We’ll compare different optimization methods to show their performance.
These gradient-based optimizers are supported: `:gradient-descent`,
`:adam` and `:quantum-natural-gradient`.

For gradient-free optimizers, we can use the following methods:
`:nelder-mead`, `:powell`, `:cmaes` and `:bobyqa`.

Here we use the adam optimizer, which is a gradient-based optimization
method that uses the parameter shift rule to compute gradients.

<div class="sourceClojure">

``` clojure
(def vqe-result
  (vqe/variational-quantum-eigensolver
   (sim/create-simulator)
   {:hamiltonian           (vqe/molecular-hydrogen-hamiltonian)
    :ansatz-type           :uccsd
    :num-qubits            4
    :num-excitations       2
    :num-layers            2
    :max-iterations        200
    :tolerance             1e-5
    :learning-rate         0.1
    :optimization-method   :adam
    :shots 1}))
```

</div>

<div class="sourceClojure">

``` clojure
vqe-result
```

</div>

<div class="printedClojure">

``` clojure
{:algorithm "Variational Quantum Eigensolver",
 :config
 {:num-excitations 2,
  :ansatz-type :uccsd,
  :optimization-method :adam,
  :tolerance 1.0E-5,
  :max-iterations 200,
  :shots 1,
  :num-qubits 4,
  :hamiltonian
  [{:coefficient -1.1395602, :pauli-string "IIII"}
   {:coefficient 0.39793742, :pauli-string "IIIZ"}
   {:coefficient -0.39793742, :pauli-string "IIZI"}
   {:coefficient 0.39793742, :pauli-string "IZII"}
   {:coefficient -0.39793742, :pauli-string "ZIII"}
   {:coefficient -0.0112801, :pauli-string "IIZZ"}
   {:coefficient -0.0112801, :pauli-string "IZIZ"}
   {:coefficient -0.0112801, :pauli-string "IZZI"}
   {:coefficient -0.0112801, :pauli-string "ZIIZ"}
   {:coefficient -0.0112801, :pauli-string "ZIZI"}
   {:coefficient -0.0112801, :pauli-string "ZZZZ"}
   {:coefficient -0.1809312, :pauli-string "XXII"}
   {:coefficient -0.1809312, :pauli-string "YYII"}
   {:coefficient -0.1809312, :pauli-string "IIXX"}
   {:coefficient -0.1809312, :pauli-string "IIYY"}],
  :learning-rate 0.1,
  :num-layers 2},
 :ansatz-type :uccsd,
 :optimization
 {:success true,
  :reason :converged,
  :optimal-energy -1.1170693627326072,
  :optimal-parameters [0.018348385348185135 0.03409768765542586],
  :iterations 9,
  :history
  [{:iteration 0,
    :energy -1.1170647458142424,
    :gradients [-0.0013438600570221393 -0.0012907770619599024],
    :parameters [0.0171217121442659 0.03290655837558223]}
   {:iteration 1,
    :energy -1.1170652398497896,
    :gradients [-0.0013485611503908368 -0.0012988724505000881],
    :parameters [0.017256098149968112 0.033035636081778216]}
   {:iteration 2,
    :energy -1.117065738509219,
    :gradients [-0.001353294820028772 -0.0013070016511625981],
    :parameters [0.017390954265007197 0.033165523326828227]}
   {:iteration 3,
    :energy -1.1170662418410884,
    :gradients [-0.0013580611902265227 -0.001315164861802276],
    :parameters [0.017526283747010075 0.033296223491944485]}
   {:iteration 4,
    :energy -1.1170667498944233,
    :gradients [-0.0013628603860466049 -0.0013233622811067436],
    :parameters [0.017662089866032727 0.03342773997812471]}
   {:iteration 5,
    :energy -1.1170672627187268,
    :gradients [-0.001367692533326803 -0.0013315941086035066],
    :parameters [0.017798375904637388 0.033560076206235384]}
   {:iteration 6,
    :energy -1.1170677803639824,
    :gradients [-0.0013725577586800597 -0.001339860544658955],
    :parameters [0.017935145157970067 0.03369323561709574]}
   {:iteration 7,
    :energy -1.117068302880658,
    :gradients [-0.0013774561895013582 -0.0013481617904883558],
    :parameters [0.01807240093383807 0.03382722167156163]}
   {:iteration 8,
    :energy -1.1170688303197152,
    :gradients [-0.0013823879539692774 -0.0013564980481539646],
    :parameters [0.018210146552788208 0.033962037850610464]}
   {:iteration 9,
    :energy -1.1170693627326072,
    :gradients [-0.0013873531810466577 -0.0013648695205753514],
    :parameters [0.018348385348185135 0.03409768765542586]}],
  :convergence-analysis
  {:converged true,
   :energy-converged true,
   :gradient-converged false,
   :parameter-stable false,
   :current-energy -1.1170693627326072,
   :gradient-norm 0.001946180273550184,
   :iterations 10,
   :recommendation :stop-converged}},
 :success true,
 :analysis
 {:initial-energy -1.1170647458142424,
  :energy-improvement 4.616918364730438E-6,
  :convergence-achieved true},
 :result -1.1170693627326072,
 :timing
 {:execution-time-ms 3356,
  :start-time 1757177348673,
  :end-time 1757177352029},
 :circuit
 {:operations
  [{:operation-type :x, :operation-params {:target 0}}
   {:operation-type :x, :operation-params {:target 1}}
   {:operation-type :ry,
    :operation-params {:target 0, :angle 0.009174192674092568}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :ry,
    :operation-params {:target 2, :angle 0.009174192674092568}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :ry,
    :operation-params {:target 0, :angle -0.009174192674092568}}
   {:operation-type :ry,
    :operation-params {:target 1, :angle 0.01704884382771293}}
   {:operation-type :cnot, :operation-params {:control 1, :target 3}}
   {:operation-type :ry,
    :operation-params {:target 3, :angle 0.01704884382771293}}
   {:operation-type :cnot, :operation-params {:control 1, :target 3}}
   {:operation-type :ry,
    :operation-params {:target 1, :angle -0.01704884382771293}}],
  :num-qubits 4,
  :name "UCCSD Inspired Ansatz"},
 :parameter-count 2,
 :hamiltonian {:terms 15, :grouped-terms nil, :classical-bound nil},
 :results
 {:optimal-energy -1.1170693627326072,
  :optimal-parameters [0.018348385348185135 0.03409768765542586],
  :success true,
  :iterations 9,
  :function-evaluations nil}}
```

</div>

The calculated ground state energy is

<div class="sourceClojure">

``` clojure
(:result vqe-result)
```

</div>

<div class="printedClojure">

``` clojure
-1.1170693627326072
```

</div>

The final circuit with the optimal parameters is

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg (:circuit vqe-result)))
```

</div>

<svg height="340" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="840" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="420" y="35">UCCSD Inspired Ansatz</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="190" y2="190"></line></g><g><text fill="#374151" font-size="14" x="30" y="255">q3 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="790" y1="250" y2="250"></line></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">X</text><title>:x gate on qubit 0</title></g><g class="gate-group"><rect fill="#ef4444" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">X</text><title>:x gate on qubit 1</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="175" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="190" y="75">RY</text><title>:ry gate on qubit 0, θ=0.009 (0.003π)</title></g><g class="gate-group"><circle cx="250" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="250" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="242" x2="258" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="250" x2="250" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="295" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="310" y="195">RY</text><title>:ry gate on qubit 2, θ=0.009 (0.003π)</title></g><g class="gate-group"><circle cx="370" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="370" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="362" x2="378" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="75">RY</text><title>:ry gate on qubit 0, θ=-0.009 (-0.003π)</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="135">RY</text><title>:ry gate on qubit 1, θ=0.017 (0.005π)</title></g><g class="gate-group"><circle cx="490" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="490" cy="250" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="482" x2="498" y1="250" y2="250"></line><line stroke="#374151" stroke-width="2" x1="490" x2="490" y1="242" y2="258"></line><line stroke="#374151" stroke-width="2" x1="490" x2="490" y1="130" y2="250"></line><title>CNOT: control=1, target=3</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="535" y="238"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="550" y="255">RY</text><title>:ry gate on qubit 3, θ=0.017 (0.005π)</title></g><g class="gate-group"><circle cx="610" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="610" cy="250" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="602" x2="618" y1="250" y2="250"></line><line stroke="#374151" stroke-width="2" x1="610" x2="610" y1="242" y2="258"></line><line stroke="#374151" stroke-width="2" x1="610" x2="610" y1="130" y2="250"></line><title>CNOT: control=1, target=3</title></g><g class="gate-group"><rect fill="#10b981" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="655" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="670" y="135">RY</text><title>:ry gate on qubit 1, θ=-0.017 (-0.005π)</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="195">M</text><title>Measure qubit 2</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="795" y="238"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="810" y="255">M</text><title>Measure qubit 3</title></g><g><text fill="#6b7280" font-size="12" x="30" y="310">Qubits: 4 | Gates: 12 | Depth: 10</text></g></svg>

### Quantum Approximation Optimization Algorithm (QAOA)

The [Quantum Approximation Optimization Algorithm
(QAOA)](https://en.wikipedia.org/wiki/Quantum_approximate_optimization_algorithm)
is a hybrid quantum-classical algorithm used to solve combinatorial
optimization problems. It is particularly useful for problems that can
be represented as a cost function, such as the Max-Cut problem, where
the goal is to partition a graph into two subsets such that the number
of edges between the subsets is maximized. The QAOA algorithm uses a
parameterized quantum circuit to prepare a trial state, and a classical
optimization algorithm to maximize the expectation value of the cost
function with respect to the trial state.

- Max-Cut Problem - a combinatorial optimization problem that can be
  represented as a graph. The goal is to partition the vertices of the
  graph into two subsets such that the number of edges between the
  subsets is maximized. The Max-Cut problem can be represented as a cost
  function, where the cost function is the number of edges between the
  two subsets. The QAOA algorithm can be used to find an approximate
  solution to the Max-Cut

- Max-SAT Problem - a combinatorial optimization problem that can be
  represented as a boolean formula in conjunctive normal form (CNF). The
  goal is to find an assignment of truth values to the variables in the
  formula that maximizes the number of satisfied clauses. The Max-SAT
  problem can be represented as a cost function, where the cost function
  is the number of satisfied clauses. The QAOA algorithm can be used to
  find an approximate solution to the Max-SAT problem.

- Traveling Salesperson Problem - a combinatorial optimization problem
  that can be represented as a graph. The goal is to find the shortest
  possible route that visits each vertex exactly once and returns to the
  starting vertex. The TSP can be represented as a cost function, where
  the cost function is the total distance of the route. The QAOA
  algorithm can be used to find an approximate solution to the TSP.

The QAOA algorithm is also used in quantum machine learning and other
optimization problems, where it can be used to find the optimal
parameters for a quantum circuit that represents a trial state.

#### Problem Statement

Given a cost function C that represents a combinatorial optimization
problem, the goal is to find the optimal solution x\* that maximizes the
cost function using as few evaluations of the cost function as possible.

#### Classical Approach

In a classical setting, finding the optimal solution to a combinatorial
optimization problem requires evaluating the cost function for all
possible solutions, which can be computationally expensive for large
problems. Classical algorithms such as simulated annealing or genetic
algorithms can be used to find approximate solutions, but they are
limited by the size of the problem and the complexity of the cost
function.

#### Quantum Approach

The QAOA algorithm allows us to find approximate solutions to
combinatorial optimization problems using a hybrid quantum-classical
approach. It leverages the power of quantum computing to prepare trial
states and measure the expectation value of the cost function, while
using classical optimization algorithms to maximize the expectation
value and find the optimal parameters for the trial state.

#### Quantum Circuit

The QAOA algorithm can be implemented using a quantum circuit with the
following steps:

1.  Prepare a parameterized quantum circuit that represents the trial
    state. The circuit can be represented as a series of quantum gates
    that depend on a set of parameters θ.
2.  Initialize the parameters θ to some initial values.
3.  Execute the quantum circuit to prepare the trial state \|ψ(θ)⟩.
4.  Measure the expectation value of the cost function C with respect to
    the trial state \|ψ(θ)⟩. This involves applying the cost function as
    a quantum gate and measuring the qubits to obtain the expectation
    value ⟨C⟩.
5.  Use a classical optimization algorithm to update the parameters θ
    based on the measured expectation value ⟨C⟩. The optimization
    algorithm can be gradient-based or gradient-free, depending on the
    problem.
6.  Repeat steps 3-5 until convergence, i.e., until the expectation
    value ⟨C⟩ does not change significantly or a maximum number of
    iterations is reached.
7.  The final expectation value ⟨C⟩ represents the optimal solution x\*
    to the combinatorial optimization problem.

To explore the QAOA algorithm, we need to require the `qaoa` namespace.

<div class="sourceClojure">

``` clojure
(require '[org.soulspace.qclojure.application.algorithm.qaoa :as qaoa])
```

</div>

Let’s define a simple triangular graph for the Max-Cut problem.

<div class="sourceClojure">

``` clojure
(def triangle-graph [[0 1 1.0] [1 2 1.0] [0 2 1.0]])
```

</div>

We can use the QAOA algorithm to solve the Max-Cut problem for the
defined graph.

<div class="sourceClojure">

``` clojure
(def triangle-qaoa-result
  (qaoa/quantum-approximate-optimization-algorithm
   (sim/create-simulator)
   {:problem-type :max-cut
    :problem-hamiltonian (qaoa/max-cut-hamiltonian triangle-graph 3)
    :problem-instance triangle-graph  ; Triangle with unit weights
    :num-qubits 3
    :num-layers 2
    :optimization-method :adam
    :max-iterations 100
    :tolerance 1e-6
    :shots 1000}))
```

</div>

The result of the QAOA algorithm is a map that contains the result of
the algorithm, the measurement outcome, and the circuit used to execute
the algorithm.

<div class="sourceClojure">

``` clojure
triangle-qaoa-result
```

</div>

<div class="printedClojure">

``` clojure
{:optimal-energy 1.9897649737075023,
 :problem-hamiltonian
 ({:coefficient 0.5, :pauli-string "III"}
  {:coefficient -0.5, :pauli-string "ZZI"}
  {:coefficient 0.5, :pauli-string "III"}
  {:coefficient -0.5, :pauli-string "IZZ"}
  {:coefficient 0.5, :pauli-string "III"}
  {:coefficient -0.5, :pauli-string "ZIZ"}),
 :total-runtime-ms 518,
 :algorithm "QAOA",
 :convergence-history [1.989764973720861 1.9897649737075023],
 :final-gradient
 [8.326672684688674E-17
  -4.440892098500626E-16
  -4.440892098500626E-16
  -1.1102230246251565E-16],
 :mixer-hamiltonian
 ({:coefficient 1.0, :pauli-string "XII"}
  {:coefficient 1.0, :pauli-string "IXI"}
  {:coefficient 1.0, :pauli-string "IIX"}),
 :problem-type :max-cut,
 :reason "converged",
 :beta-parameters [0.19000000004440892 0.21000000001110222],
 :approximation-ratio nil,
 :success true,
 :result 1.9897649737075023,
 :iterations 1,
 :circuit
 {:operations
  [{:operation-type :h, :operation-params {:target 0}}
   {:operation-type :h, :operation-params {:target 1}}
   {:operation-type :h, :operation-params {:target 2}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :rz,
    :operation-params {:target 1, :angle -0.3699999999916733}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :rz,
    :operation-params {:target 2, :angle -0.3699999999916733}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :rz,
    :operation-params {:target 2, :angle -0.3699999999916733}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :rx,
    :operation-params {:target 0, :angle 0.38000000008881785}}
   {:operation-type :rx,
    :operation-params {:target 1, :angle 0.38000000008881785}}
   {:operation-type :rx,
    :operation-params {:target 2, :angle 0.38000000008881785}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :rz,
    :operation-params {:target 1, :angle -0.4200000000444089}}
   {:operation-type :cnot, :operation-params {:control 0, :target 1}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :rz,
    :operation-params {:target 2, :angle -0.4200000000444089}}
   {:operation-type :cnot, :operation-params {:control 1, :target 2}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :rz,
    :operation-params {:target 2, :angle -0.4200000000444089}}
   {:operation-type :cnot, :operation-params {:control 0, :target 2}}
   {:operation-type :rx,
    :operation-params {:target 0, :angle 0.42000000002220444}}
   {:operation-type :rx,
    :operation-params {:target 1, :angle 0.42000000002220444}}
   {:operation-type :rx,
    :operation-params {:target 2, :angle 0.42000000002220444}}],
  :num-qubits 3,
  :name
  "QAOA Ansatz + Hamiltonian Evolution + Hamiltonian Evolution + Hamiltonian Evolution + Hamiltonian Evolution"},
 :num-qubits 3,
 :gamma-parameters [0.3699999999916733 0.4200000000444089],
 :function-evaluations 8,
 :optimal-parameters
 [0.3699999999916733
  0.19000000004440892
  0.4200000000444089
  0.21000000001110222],
 :num-layers 2}
```

</div>

The result shows that the QAOA algorithm approximated the optimal
solution for the Max-Cut problem on the triangular graph, which is 2.0.

<div class="sourceClojure">

``` clojure
(:result triangle-qaoa-result)
```

</div>

<div class="printedClojure">

``` clojure
1.9897649737075023
```

</div>

The final circuit with the optimal parameters is

<div class="sourceClojure">

``` clojure
(kind/html (viz/visualize-circuit :svg (:circuit triangle-qaoa-result)))
```

</div>

<svg height="280" style="background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px;" width="1500" xmlns="http://www.w3.org/2000/svg"><defs><style>.gate-group:hover rect { opacity: 1; stroke-width: 3; }
                         .gate-group:hover circle { stroke-width: 3; }
                         text { font-family: &apos;SF Pro Display&apos;, &apos;Segoe UI&apos;, system-ui, sans-serif; }</style></defs><text fill="#111827" font-size="18" font-weight="bold" text-anchor="middle" x="750" y="35">QAOA Ansatz + Hamiltonian Evolution + Hamiltonian Evolution + Hamiltonian Evolution + Hamiltonian Evolution</text><g><text fill="#374151" font-size="14" x="30" y="75">q0 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="70" y2="70"></line></g><g><text fill="#374151" font-size="14" x="30" y="135">q1 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="130" y2="130"></line></g><g><text fill="#374151" font-size="14" x="30" y="195">q2 |0⟩</text><line stroke="#9ca3af" stroke-width="2" x1="70" x2="1450" y1="190" y2="190"></line></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="75">H</text><title>:h gate on qubit 0</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="135">H</text><title>:h gate on qubit 1</title></g><g class="gate-group"><rect fill="#8b5cf6" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="115" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="130" y="195">H</text><title>:h gate on qubit 2</title></g><g class="gate-group"><circle cx="190" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="190" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="182" x2="198" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="190" x2="190" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="235" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="250" y="135">RZ</text><title>:rz gate on qubit 1, φ=-0.37 (-0.118π)</title></g><g class="gate-group"><circle cx="310" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="310" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="302" x2="318" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="310" x2="310" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><circle cx="370" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="370" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="362" x2="378" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="370" x2="370" y1="130" y2="190"></line><title>CNOT: control=1, target=2</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="415" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="430" y="195">RZ</text><title>:rz gate on qubit 2, φ=-0.37 (-0.118π)</title></g><g class="gate-group"><circle cx="490" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="490" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="482" x2="498" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="490" x2="490" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="490" x2="490" y1="130" y2="190"></line><title>CNOT: control=1, target=2</title></g><g class="gate-group"><circle cx="550" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="550" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="542" x2="558" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="550" x2="550" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="595" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="610" y="195">RZ</text><title>:rz gate on qubit 2, φ=-0.37 (-0.118π)</title></g><g class="gate-group"><circle cx="670" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="670" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="662" x2="678" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="670" x2="670" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="670" x2="670" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="715" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="730" y="75">RX</text><title>:rx gate on qubit 0, θ=0.38 (0.121π)</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="715" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="730" y="135">RX</text><title>:rx gate on qubit 1, θ=0.38 (0.121π)</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="715" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="730" y="195">RX</text><title>:rx gate on qubit 2, θ=0.38 (0.121π)</title></g><g class="gate-group"><circle cx="790" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="790" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="782" x2="798" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="790" x2="790" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="790" x2="790" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="835" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="850" y="135">RZ</text><title>:rz gate on qubit 1, φ=-0.42 (-0.134π)</title></g><g class="gate-group"><circle cx="910" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="910" cy="130" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="902" x2="918" y1="130" y2="130"></line><line stroke="#374151" stroke-width="2" x1="910" x2="910" y1="122" y2="138"></line><line stroke="#374151" stroke-width="2" x1="910" x2="910" y1="70" y2="130"></line><title>CNOT: control=0, target=1</title></g><g class="gate-group"><circle cx="970" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="970" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="962" x2="978" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="970" x2="970" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="970" x2="970" y1="130" y2="190"></line><title>CNOT: control=1, target=2</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1015" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1030" y="195">RZ</text><title>:rz gate on qubit 2, φ=-0.42 (-0.134π)</title></g><g class="gate-group"><circle cx="1090" cy="130" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="1090" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="1082" x2="1098" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="1090" x2="1090" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="1090" x2="1090" y1="130" y2="190"></line><title>CNOT: control=1, target=2</title></g><g class="gate-group"><circle cx="1150" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="1150" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="1142" x2="1158" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="1150" x2="1150" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="1150" x2="1150" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#6366f1" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1195" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1210" y="195">RZ</text><title>:rz gate on qubit 2, φ=-0.42 (-0.134π)</title></g><g class="gate-group"><circle cx="1270" cy="70" fill="#374151" r="6" stroke="#ffffff" stroke-width="2"></circle><circle cx="1270" cy="190" fill="none" r="12" stroke="#374151" stroke-width="2"></circle><line stroke="#374151" stroke-width="2" x1="1262" x2="1278" y1="190" y2="190"></line><line stroke="#374151" stroke-width="2" x1="1270" x2="1270" y1="182" y2="198"></line><line stroke="#374151" stroke-width="2" x1="1270" x2="1270" y1="70" y2="190"></line><title>CNOT: control=0, target=2</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1315" y="58"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1330" y="75">RX</text><title>:rx gate on qubit 0, θ=0.42 (0.134π)</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1315" y="118"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1330" y="135">RX</text><title>:rx gate on qubit 1, θ=0.42 (0.134π)</title></g><g class="gate-group"><rect fill="#ec4899" height="24" rx="4" stroke="#ffffff" stroke-width="2" width="30" x="1315" y="178"></rect><text fill="#ffffff" font-size="12" font-weight="bold" text-anchor="middle" x="1330" y="195">RX</text><title>:rx gate on qubit 2, θ=0.42 (0.134π)</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="58"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="75">M</text><title>Measure qubit 0</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="118"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="135">M</text><title>Measure qubit 1</title></g><g><rect fill="#fbbf24" height="24" rx="4" stroke="#f59e0b" stroke-width="2" width="30" x="1455" y="178"></rect><text fill="#92400e" font-size="10" font-weight="bold" text-anchor="middle" x="1470" y="195">M</text><title>Measure qubit 2</title></g><g><text fill="#6b7280" font-size="12" x="30" y="250">Qubits: 3 | Gates: 27 | Depth: 21</text></g></svg>

Let’s visualize the final quantum state after executing the QAOA
algorithm.

(kind/html (viz/visualize-quantum-state :svg (get-in
triangle-qaoa-result \[:execution-result :final-state\])))

The final quantum state shows the approximation of the optimal solution
to the Max-Cut problem for the triangular graph. The final quantum state
is a superposition of the states that represent the optimal solution to
the Max-Cut problem.

<div style="background-color:grey;height:2px;width:100%;"></div>

<div><pre><small><small>source: <a href="https://github.com/lsolbach/qclojure/blob/main/notebook/tutorial.clj">notebook/tutorial.clj</a></small></small></pre></div>
